<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BOSS Afterburner: RhopiAlg.cxx Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BOSS Afterburner
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('RhopiAlg_8cxx_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">RhopiAlg.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="RhopiAlg_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// * ========================= * //</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// * ------- LIBRARIES ------- * //</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// * ========================= * //</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">    #include &quot;CLHEP/Geometry/Point3D.h&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">    #include &quot;CLHEP/Vector/LorentzVector.h&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">    #include &quot;CLHEP/Vector/ThreeVector.h&quot;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">    #include &quot;CLHEP/Vector/TwoVector.h&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">    #include &quot;DstEvent/TofHitStatus.h&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">    #include &quot;EventModel/Event.h&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">    #include &quot;EventModel/EventHeader.h&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">    #include &quot;EventModel/EventModel.h&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">    #include &quot;EvtRecEvent/EvtRecEvent.h&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">    #include &quot;EvtRecEvent/EvtRecTrack.h&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">    #include &quot;GaudiKernel/AlgFactory.h&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">    #include &quot;GaudiKernel/Bootstrap.h&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">    #include &quot;GaudiKernel/IDataProviderSvc.h&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">    #include &quot;GaudiKernel/IHistogramSvc.h&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">    #include &quot;GaudiKernel/INTupleSvc.h&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">    #include &quot;GaudiKernel/ISvcLocator.h&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">    #include &quot;GaudiKernel/ISvcLocator.h&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">    #include &quot;GaudiKernel/MsgStream.h&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">    #include &quot;GaudiKernel/NTuple.h&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">    #include &quot;GaudiKernel/PropertyMgr.h&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">    #include &quot;GaudiKernel/SmartDataPtr.h&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">    #include &quot;ParticleID/ParticleID.h&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">    #include &quot;<a class="code" href="RhopiAlg_8h.html">RhopiAlg/RhopiAlg.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">    #include &quot;TMath.h&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">    #include &quot;VertexFit/Helix.h&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">    #include &quot;VertexFit/IVertexDbSvc.h&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">    #include &quot;VertexFit/KalmanKinematicFit.h&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">    #include &quot;VertexFit/VertexFit.h&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">    #include &lt;vector&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// #include &quot;VertexFit/KinematicFit.h&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">    #ifndef ENABLE_BACKWARDS_COMPATIBILITY</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#a188faf2fae63125a32fe38f0567026bc">   35</a></span>&#160;        <span class="keyword">typedef</span> HepGeom::Point3D&lt;double&gt; <a class="code" href="RhopiAlg_8cxx.html#a188faf2fae63125a32fe38f0567026bc">HepPoint3D</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">using</span> CLHEP::Hep2Vector;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">using</span> CLHEP::Hep3Vector;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keyword">using</span> CLHEP::HepLorentzVector;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// * ==================================== * //</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// * ------- GLOBALS AND TYPEDEFS ------- * //</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// * ==================================== * //</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// * Constants * //</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#ab7b35acf658c14d92b5b892a4fa74761">   48</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="RhopiAlg_8cxx.html#ab7b35acf658c14d92b5b892a4fa74761">mpi0</a>  = 0.13957; <span class="comment">// mass of pi0</span></div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#a359fc7286cb3fe45739029aab90fef22">   49</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="RhopiAlg_8cxx.html#a359fc7286cb3fe45739029aab90fef22">mrho0</a> = 0.770;   <span class="comment">// mass of rho0</span></div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#a850891ce5a4a85d92f96c37288dc134a">   50</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="RhopiAlg_8cxx.html#a850891ce5a4a85d92f96c37288dc134a">xmass</a>[5] = {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            0.000511, <span class="comment">// electron</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            0.105658, <span class="comment">// muon</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            0.139570, <span class="comment">// charged pion</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            0.493677, <span class="comment">// charged kaon</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            0.938272  <span class="comment">// proton</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        };</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#ac2ba08e98354f1ae771562ba95993cee">   57</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="RhopiAlg_8cxx.html#ac2ba08e98354f1ae771562ba95993cee">velc_cm</a> = 29.9792458; <span class="comment">// tof_path unit in cm.</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#aa99b02ee88055b799a547ebf230ed310">   58</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="RhopiAlg_8cxx.html#aa99b02ee88055b799a547ebf230ed310">velc_mm</a> = 299.792458; <span class="comment">// tof path unit in mm</span></div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#a123ac7871ce3ce2f3ef73eddc6aae85a">   59</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="RhopiAlg_8cxx.html#a123ac7871ce3ce2f3ef73eddc6aae85a">Ecms</a> = 3.097;<span class="comment">// center-of-mass energy</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// * Typedefs * //</span></div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#ae2aff2e5ed6ce2ac4391bedb93e0a615">   63</a></span>&#160;        <span class="keyword">typedef</span> std::vector&lt;int&gt; <a class="code" href="RhopiAlg_8cxx.html#ae2aff2e5ed6ce2ac4391bedb93e0a615">Vint</a>;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#a66098539bec38058a3d9032d53cbd7ec">   64</a></span>&#160;        <span class="keyword">typedef</span> std::vector&lt;HepLorentzVector&gt; <a class="code" href="RhopiAlg_8cxx.html#a66098539bec38058a3d9032d53cbd7ec">Vp4</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// * Counters for generating cut flow * //</span></div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#a83e267c1596c352aefaeb2c2551d637c">   68</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="RhopiAlg_8cxx.html#a83e267c1596c352aefaeb2c2551d637c">Ncut0</a>; <span class="comment">// counter for all events (no cuts)</span></div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#a4506054600e8230d869ac3c51e807f3a">   69</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="RhopiAlg_8cxx.html#a4506054600e8230d869ac3c51e807f3a">Ncut1</a>; <span class="comment">// nGood!=2 or nCharge!=0</span></div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#a11b83c587312d370e5ce54dade6d117c">   70</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="RhopiAlg_8cxx.html#a11b83c587312d370e5ce54dade6d117c">Ncut2</a>; <span class="comment">// number of photons &lt; 2</span></div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#abdd8572dc795b0d4176087cdc0a2bfe1">   71</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="RhopiAlg_8cxx.html#abdd8572dc795b0d4176087cdc0a2bfe1">Ncut3</a>; <span class="comment">// pass PID</span></div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#afc66a2c95f4c764112c430d34ac53985">   72</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="RhopiAlg_8cxx.html#afc66a2c95f4c764112c430d34ac53985">Ncut4</a>; <span class="comment">// pass fit4c</span></div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#a87a44bb9989e7d593d89d0b2b7aa553d">   73</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="RhopiAlg_8cxx.html#a87a44bb9989e7d593d89d0b2b7aa553d">Ncut5</a>; <span class="comment">// pass fit5c</span></div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="RhopiAlg_8cxx.html#af1d2be22861b1e83a550b9ca430b58cf">   74</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="RhopiAlg_8cxx.html#af1d2be22861b1e83a550b9ca430b58cf">Ncut6</a>; <span class="comment">// &quot;geff&quot; branch</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">// * =========================== * //</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">// * ------- CONSTRUCTOR ------- * //</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">// * =========================== * //</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span><span class="comment">// Algorithms should inherit from Gaudi&#39;s `Algorithm` class. See https://dayabay.bnl.gov/dox/GaudiKernel/html/classAlgorithm.html.</span></div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classRhopiAlg.html#a7f0176ebbd3cceef08cf5a8005ff2bdb">   86</a></span>&#160;<a class="code" href="classRhopiAlg.html#a7f0176ebbd3cceef08cf5a8005ff2bdb">RhopiAlg::RhopiAlg</a>(<span class="keyword">const</span> std::string&amp; name, ISvcLocator* pSvcLocator) :</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    Algorithm(name, pSvcLocator) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// * Define r0, z0 cut for charged tracks *</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    declareProperty(<span class="stringliteral">&quot;Vr0cut&quot;</span>,    <a class="code" href="classRhopiAlg.html#a1dae4ef59a4492c62a8255a169251e3c">fVr0cut</a>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    declareProperty(<span class="stringliteral">&quot;Vz0cut&quot;</span>,    <a class="code" href="classRhopiAlg.html#adaa4db6028d5fcada93dc8070152c1ed">fVz0cut</a>);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    declareProperty(<span class="stringliteral">&quot;Vrvz0cut&quot;</span>,  <a class="code" href="classRhopiAlg.html#a9de83fa5c1b9f04c43c833732acdaea7">fRvz0cut</a>);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    declareProperty(<span class="stringliteral">&quot;Vrvxy0cut&quot;</span>, <a class="code" href="classRhopiAlg.html#aceb706c5131c32c60ebccff68f7c5400">fRvxy0cut</a>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// * Define energy, dphi, dthe cuts for fake gamma&#39;s *</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    declareProperty(<span class="stringliteral">&quot;EnergyThreshold&quot;</span>, <a class="code" href="classRhopiAlg.html#a0ac1cb08a0a7b847b4a50e35dd6a5434">fEnergyThreshold</a>);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    declareProperty(<span class="stringliteral">&quot;GammaPhiCut&quot;</span>,     <a class="code" href="classRhopiAlg.html#a2c907b2b6d12917ce44b4cf8442738ff">fGammaPhiCut</a>);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    declareProperty(<span class="stringliteral">&quot;GammaThetaCut&quot;</span>,   <a class="code" href="classRhopiAlg.html#ae453281b12586262b1bb4f058ee1e6bf">fGammaThetaCut</a>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    declareProperty(<span class="stringliteral">&quot;GammaAngleCut&quot;</span>,   <a class="code" href="classRhopiAlg.html#a00972c94ffc8686f548a1597073ae5d8">fGammaAngleCut</a>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// * Define invariant mass window cut *</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    declareProperty(<span class="stringliteral">&quot;dM_rho0&quot;</span>, <a class="code" href="classRhopiAlg.html#a2813e7bba4ead1913f5bd883cf475e65">fDeltaMrho0</a> = .150);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// * Whether to test the success of the 4- and 5-constraint fits *</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    declareProperty(<span class="stringliteral">&quot;Test4C&quot;</span>,   <a class="code" href="classRhopiAlg.html#a85bfe78eb173354f1755694067deb1a0">fElectronst4C</a>); <span class="comment">// write fit4c</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    declareProperty(<span class="stringliteral">&quot;Test5C&quot;</span>,   <a class="code" href="classRhopiAlg.html#a9a362aa88caa02920d0e8dc7bbb406f1">fElectronst5C</a>); <span class="comment">// write fit5c and geff</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    declareProperty(<span class="stringliteral">&quot;MaxChiSq&quot;</span>, <a class="code" href="classRhopiAlg.html#a3879d5b03e9cd0fd30d8f151f930b024">fMaxChiSq</a>); <span class="comment">// chisq for both fits should be less</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// * Whether or not to check success of Particle Identification *</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    declareProperty(<span class="stringliteral">&quot;CheckDedx&quot;</span>, <a class="code" href="classRhopiAlg.html#a611af9831ff29dd16b8d255bbab8268b">fCheckDedx</a>);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    declareProperty(<span class="stringliteral">&quot;CheckTof&quot;</span>,  <a class="code" href="classRhopiAlg.html#a67fee3f1672e9ae8754235e4d67bcf9a">fCheckTof</a>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">// * ========================== * //</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">// * ------- INITIALIZE ------- * //</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">// * ========================== * //</span></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classRhopiAlg.html#a42987b298b549df8af27578a7c8160f6">  124</a></span>&#160;<span class="comment"></span>StatusCode <a class="code" href="classRhopiAlg.html#a42987b298b549df8af27578a7c8160f6">RhopiAlg::initialize</a>(){</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    MsgStream log(msgSvc(), name());</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    log &lt;&lt; MSG::INFO &lt;&lt; <span class="stringliteral">&quot;In initialize():&quot;</span> &lt;&lt; endmsg;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// * NTuple: Vertex position (vxyz) * //</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        NTuplePtr nt1(ntupleSvc(), <span class="stringliteral">&quot;FILE1/vxyz&quot;</span>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">if</span> ( nt1 ) <a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a> = nt1;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a> = ntupleSvc()-&gt;book(<span class="stringliteral">&quot;FILE1/vxyz&quot;</span>, CLID_ColumnWiseTuple, <span class="stringliteral">&quot;ks N-Tuple example&quot;</span>);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a>) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a>-&gt;addItem(<span class="stringliteral">&quot;vx0&quot;</span>,    <a class="code" href="classRhopiAlg.html#a843b32c7856026e97d87b7566dcec4de">fVx0</a>);    <span class="comment">// primary x-vertex as determined by MDC</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a>-&gt;addItem(<span class="stringliteral">&quot;vy0&quot;</span>,    <a class="code" href="classRhopiAlg.html#a24d545fdc4dcc0bd351ced7527104445">fVy0</a>);    <span class="comment">// primary y-vertex as determined by MDC</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a>-&gt;addItem(<span class="stringliteral">&quot;vz0&quot;</span>,    <a class="code" href="classRhopiAlg.html#a2cd6ce4caafc790e99087214fb6a4e08">fVz0</a>);    <span class="comment">// primary z-vertex as determined by MDC</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a>-&gt;addItem(<span class="stringliteral">&quot;vr0&quot;</span>,    <a class="code" href="classRhopiAlg.html#a476a80614bc98f956f3f4e85c09184e6">fVr0</a>);    <span class="comment">// distance from origin in xy-plane</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a>-&gt;addItem(<span class="stringliteral">&quot;rvxy0&quot;</span>,  <a class="code" href="classRhopiAlg.html#a383964930e74fe9fc4f3bacde18b3423">fRvxy0</a>);  <span class="comment">// nearest distance to IP in xy plane</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a>-&gt;addItem(<span class="stringliteral">&quot;rvz0&quot;</span>,   <a class="code" href="classRhopiAlg.html#a8e349c1966478c78c8489c9d9e5a826b">fRvz0</a>);   <span class="comment">// nearest distance to IP in z direction</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a>-&gt;addItem(<span class="stringliteral">&quot;rvphi0&quot;</span>, <a class="code" href="classRhopiAlg.html#a104623b8329459f4a38b3d2b967f27c2">fRvphi0</a>); <span class="comment">// angle in the xy-plane (?)</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                log &lt;&lt; MSG::ERROR &lt;&lt; <span class="stringliteral">&quot;    Cannot book N-tuple:&quot;</span> &lt;&lt; long(<a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a>) &lt;&lt; endmsg;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="keywordflow">return</span> StatusCode::FAILURE;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// * NTuple: Photon kinematics (photon) * //</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        NTuplePtr nt2(ntupleSvc(), <span class="stringliteral">&quot;FILE1/photon&quot;</span>);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">if</span> ( nt2 ) <a class="code" href="classRhopiAlg.html#a188bc0198dd44ae64e236099f2409c56">fTupleAngles</a> = nt2;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="classRhopiAlg.html#a188bc0198dd44ae64e236099f2409c56">fTupleAngles</a> = ntupleSvc()-&gt;book(<span class="stringliteral">&quot;FILE1/photon&quot;</span>, CLID_ColumnWiseTuple, <span class="stringliteral">&quot;ks N-Tuple example&quot;</span>);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a188bc0198dd44ae64e236099f2409c56">fTupleAngles</a>) {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <a class="code" href="classRhopiAlg.html#a188bc0198dd44ae64e236099f2409c56">fTupleAngles</a>-&gt;addItem(<span class="stringliteral">&quot;dthe&quot;</span>, <a class="code" href="classRhopiAlg.html#a759992581423aee745872348f9733ccf">fDeltaTheta</a>); <span class="comment">// theta difference with nearest charged track (degrees)</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <a class="code" href="classRhopiAlg.html#a188bc0198dd44ae64e236099f2409c56">fTupleAngles</a>-&gt;addItem(<span class="stringliteral">&quot;dphi&quot;</span>, <a class="code" href="classRhopiAlg.html#a377fb2c23a974a2bf751176e2a67ee38">fDeltaPhi</a>); <span class="comment">// phi difference with nearest charged track (degrees)</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <a class="code" href="classRhopiAlg.html#a188bc0198dd44ae64e236099f2409c56">fTupleAngles</a>-&gt;addItem(<span class="stringliteral">&quot;dang&quot;</span>, <a class="code" href="classRhopiAlg.html#a052ad1d216f1006d00a162f7a2548111">fDeltaAngle</a>); <span class="comment">// angle difference with nearest charged track</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <a class="code" href="classRhopiAlg.html#a188bc0198dd44ae64e236099f2409c56">fTupleAngles</a>-&gt;addItem(<span class="stringliteral">&quot;eraw&quot;</span>, <a class="code" href="classRhopiAlg.html#a3ad054a1e60f0a8dc4ba3e5ab066b229">fEraw</a>); <span class="comment">// energy of the photon</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                log &lt;&lt; MSG::ERROR &lt;&lt; <span class="stringliteral">&quot;    Cannot book N-tuple:&quot;</span> &lt;&lt; long(<a class="code" href="classRhopiAlg.html#a188bc0198dd44ae64e236099f2409c56">fTupleAngles</a>) &lt;&lt; endmsg;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="keywordflow">return</span> StatusCode::FAILURE;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// * NTuple: Energy branch (etot) * //</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        NTuplePtr nt3(ntupleSvc(), <span class="stringliteral">&quot;FILE1/etot&quot;</span>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">if</span> ( nt3 ) <a class="code" href="classRhopiAlg.html#a6a7475fe62353cd97e797b6ade82c53b">fTupleMgg</a> = nt3;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="classRhopiAlg.html#a6a7475fe62353cd97e797b6ade82c53b">fTupleMgg</a> = ntupleSvc()-&gt;book(<span class="stringliteral">&quot;FILE1/etot&quot;</span>, CLID_ColumnWiseTuple, <span class="stringliteral">&quot;ks N-Tuple example&quot;</span>);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a6a7475fe62353cd97e797b6ade82c53b">fTupleMgg</a>) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <a class="code" href="classRhopiAlg.html#a6a7475fe62353cd97e797b6ade82c53b">fTupleMgg</a>-&gt;addItem(<span class="stringliteral">&quot;m2gg&quot;</span>, <a class="code" href="classRhopiAlg.html#a8d07c968212f4b83442f49e254dd2670">fMtoGG</a>); <span class="comment">// invariant mass of the two gammas</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <a class="code" href="classRhopiAlg.html#a6a7475fe62353cd97e797b6ade82c53b">fTupleMgg</a>-&gt;addItem(<span class="stringliteral">&quot;etot&quot;</span>, <a class="code" href="classRhopiAlg.html#a1d88c12fcd397ee20c4f49f5afc68c6d">fEtot</a>); <span class="comment">// total energy of pi^+, pi^ and the two gammas</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                log &lt;&lt; MSG::ERROR &lt;&lt; <span class="stringliteral">&quot;    Cannot book N-tuple:&quot;</span> &lt;&lt; long(<a class="code" href="classRhopiAlg.html#a6a7475fe62353cd97e797b6ade82c53b">fTupleMgg</a>) &lt;&lt; endmsg;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="keywordflow">return</span> StatusCode::FAILURE;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// * NTuple: Neutral pion (pi0) fit branch (fit4c) * //</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a85bfe78eb173354f1755694067deb1a0">fElectronst4C</a>) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            NTuplePtr nt4(ntupleSvc(), <span class="stringliteral">&quot;FILE1/fit4c&quot;</span>);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordflow">if</span> ( nt4 ) <a class="code" href="classRhopiAlg.html#ac9c83f29cbf8dcd882f21e0f41d72ee6">fTupleFit4C</a> = nt4;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <a class="code" href="classRhopiAlg.html#ac9c83f29cbf8dcd882f21e0f41d72ee6">fTupleFit4C</a> = ntupleSvc()-&gt;book(<span class="stringliteral">&quot;FILE1/fit4c&quot;</span>, CLID_ColumnWiseTuple, <span class="stringliteral">&quot;ks N-Tuple example&quot;</span>);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#ac9c83f29cbf8dcd882f21e0f41d72ee6">fTupleFit4C</a> ) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    <a class="code" href="classRhopiAlg.html#ac9c83f29cbf8dcd882f21e0f41d72ee6">fTupleFit4C</a>-&gt;addItem(<span class="stringliteral">&quot;mpi0&quot;</span>, <a class="code" href="classRhopiAlg.html#ae291cc82d5644cd4d7224c3fbce754b5">fMpi0</a>); <span class="comment">// invariant pi0 mass according to Kalman kinematic fit</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    <a class="code" href="classRhopiAlg.html#ac9c83f29cbf8dcd882f21e0f41d72ee6">fTupleFit4C</a>-&gt;addItem(<span class="stringliteral">&quot;chi2&quot;</span>, <a class="code" href="classRhopiAlg.html#a600c1aa0400ea9d9e5c7226a51978c94">fChi1</a>); <span class="comment">// chi square of the Kalman kinematic fit</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    log &lt;&lt; MSG::ERROR &lt;&lt; <span class="stringliteral">&quot;    Cannot book N-tuple:&quot;</span> &lt;&lt; long(<a class="code" href="classRhopiAlg.html#ac9c83f29cbf8dcd882f21e0f41d72ee6">fTupleFit4C</a>) &lt;&lt; endmsg;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    <span class="keywordflow">return</span> StatusCode::FAILURE;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// * NTuple: Rho fit branch (fit5c) * //</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a9a362aa88caa02920d0e8dc7bbb406f1">fElectronst5C</a>) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            NTuplePtr nt5(ntupleSvc(), <span class="stringliteral">&quot;FILE1/fit5c&quot;</span>);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">if</span> ( nt5 ) <a class="code" href="classRhopiAlg.html#a6f247d2dc0ce778e5986912139bd5ef5">fTupleFit5C</a> = nt5;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                <a class="code" href="classRhopiAlg.html#a6f247d2dc0ce778e5986912139bd5ef5">fTupleFit5C</a> = ntupleSvc()-&gt;book(<span class="stringliteral">&quot;FILE1/fit5c&quot;</span>, CLID_ColumnWiseTuple, <span class="stringliteral">&quot;ks N-Tuple example&quot;</span>);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a6f247d2dc0ce778e5986912139bd5ef5">fTupleFit5C</a>) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    <a class="code" href="classRhopiAlg.html#a6f247d2dc0ce778e5986912139bd5ef5">fTupleFit5C</a>-&gt;addItem(<span class="stringliteral">&quot;chi2&quot;</span>,  <a class="code" href="classRhopiAlg.html#a866d950f28ee6301700e2cd323033ee3">fChi2</a>);  <span class="comment">// chi squared of the Kalman kinematic fit</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    <a class="code" href="classRhopiAlg.html#a6f247d2dc0ce778e5986912139bd5ef5">fTupleFit5C</a>-&gt;addItem(<span class="stringliteral">&quot;mrho0&quot;</span>, <a class="code" href="classRhopiAlg.html#a260c4fad9f54ab4a7d326a8177696b99">fMrho0</a>); <span class="comment">// inv. mass pi^+ pi^- (rho^0)</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    <a class="code" href="classRhopiAlg.html#a6f247d2dc0ce778e5986912139bd5ef5">fTupleFit5C</a>-&gt;addItem(<span class="stringliteral">&quot;mrhop&quot;</span>, <a class="code" href="classRhopiAlg.html#aac54be27822ab83575a16ad4b796ad78">fMrhop</a>); <span class="comment">// inv. mass pi^0 pi^+ (rho^+)</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    <a class="code" href="classRhopiAlg.html#a6f247d2dc0ce778e5986912139bd5ef5">fTupleFit5C</a>-&gt;addItem(<span class="stringliteral">&quot;mrhom&quot;</span>, <a class="code" href="classRhopiAlg.html#a624b27fcf9cc3ec90cc6ddf7326f3dc6">fMrhom</a>); <span class="comment">// inv. mass pi^0 pi^- (rho^-)</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    log &lt;&lt; MSG::ERROR &lt;&lt; <span class="stringliteral">&quot;    Cannot book N-tuple:&quot;</span> &lt;&lt; long(<a class="code" href="classRhopiAlg.html#a6f247d2dc0ce778e5986912139bd5ef5">fTupleFit5C</a>) &lt;&lt; endmsg;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    <span class="keywordflow">return</span> StatusCode::FAILURE;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// * NTuple: Photon detection efficiences (geff) * //</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            NTuplePtr nt6(ntupleSvc(), <span class="stringliteral">&quot;FILE1/geff&quot;</span>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">if</span> ( nt6 ) <a class="code" href="classRhopiAlg.html#ad6449cfc87feeea89302fb1e8667c7ac">fTuplePhoton</a> = nt6;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <a class="code" href="classRhopiAlg.html#ad6449cfc87feeea89302fb1e8667c7ac">fTuplePhoton</a> = ntupleSvc()-&gt;book(<span class="stringliteral">&quot;FILE1/geff&quot;</span>, CLID_ColumnWiseTuple, <span class="stringliteral">&quot;ks N-Tuple example&quot;</span>);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#ad6449cfc87feeea89302fb1e8667c7ac">fTuplePhoton</a>) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    <a class="code" href="classRhopiAlg.html#ad6449cfc87feeea89302fb1e8667c7ac">fTuplePhoton</a>-&gt;addItem(<span class="stringliteral">&quot;fcos&quot;</span>, <a class="code" href="classRhopiAlg.html#aaf3f9c4545d1737b04ef0ad329cb37bd">fFcos</a>); <span class="comment">// E/p ratio for pi^0 candidate</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    <a class="code" href="classRhopiAlg.html#ad6449cfc87feeea89302fb1e8667c7ac">fTuplePhoton</a>-&gt;addItem(<span class="stringliteral">&quot;elow&quot;</span>, <a class="code" href="classRhopiAlg.html#a62aafbfcb46680e0ea0ed0ff3a5a2c84">fElow</a>); <span class="comment">// lowest energy of the two gammas</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    log &lt;&lt; MSG::ERROR &lt;&lt; <span class="stringliteral">&quot;    Cannot book N-tuple:&quot;</span> &lt;&lt; long(<a class="code" href="classRhopiAlg.html#ad6449cfc87feeea89302fb1e8667c7ac">fTuplePhoton</a>) &lt;&lt; endmsg;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                    <span class="keywordflow">return</span> StatusCode::FAILURE;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// * NTuple: Import dE/dx PID branch (dedx) * //</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a611af9831ff29dd16b8d255bbab8268b">fCheckDedx</a>) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            NTuplePtr nt7(ntupleSvc(), <span class="stringliteral">&quot;FILE1/dedx&quot;</span>);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">if</span> ( nt7 ) <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a> = nt7;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a> = ntupleSvc()-&gt;book(<span class="stringliteral">&quot;FILE1/dedx&quot;</span>, CLID_ColumnWiseTuple, <span class="stringliteral">&quot;ks N-Tuple example&quot;</span>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>) {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>-&gt;addItem(<span class="stringliteral">&quot;ptrk&quot;</span>,   <a class="code" href="classRhopiAlg.html#a7318cf3dc4112c5ec68d1c8f963326db">fPtrack</a>);   <span class="comment">// momentum of the track</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>-&gt;addItem(<span class="stringliteral">&quot;chie&quot;</span>,   <a class="code" href="classRhopiAlg.html#aab7b47430f7eb3fcc1e74b0c8b6c4fcf">fChi2e</a>);   <span class="comment">// chi2 in case of electron</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>-&gt;addItem(<span class="stringliteral">&quot;chimu&quot;</span>,  <a class="code" href="classRhopiAlg.html#a64a48c1045ed925d010badcafc28ddfd">fChi2mu</a>);  <span class="comment">// chi2 in case of muon</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>-&gt;addItem(<span class="stringliteral">&quot;chipi&quot;</span>,  <a class="code" href="classRhopiAlg.html#a4f698122f565c49a9c12934078eb1f64">fChi2pi</a>);  <span class="comment">// chi2 in case of pion</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>-&gt;addItem(<span class="stringliteral">&quot;chik&quot;</span>,   <a class="code" href="classRhopiAlg.html#a1b65a274eaffc58ed048746eb3e446ff">fChi2k</a>);   <span class="comment">// chi2 in case of kaon</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>-&gt;addItem(<span class="stringliteral">&quot;chip&quot;</span>,   <a class="code" href="classRhopiAlg.html#af36844ec30aa092b60451a65f2abbfc1">fChi2p</a>);   <span class="comment">// chi2 in case of proton</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>-&gt;addItem(<span class="stringliteral">&quot;probPH&quot;</span>, <a class="code" href="classRhopiAlg.html#aebb4764f43dc107037bbafc4cc5ba07f">fProbPH</a>); <span class="comment">// most probable pulse height from truncated mean</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>-&gt;addItem(<span class="stringliteral">&quot;normPH&quot;</span>, <a class="code" href="classRhopiAlg.html#a2104747b628e5e2ca62eea29eab08257">fNormPH</a>); <span class="comment">// normalized pulse height</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>-&gt;addItem(<span class="stringliteral">&quot;ghit&quot;</span>,   <a class="code" href="classRhopiAlg.html#a33d8b54f4c89d710b9a3f3c9512c2cf2">fGhit</a>);   <span class="comment">// number of good hits</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>-&gt;addItem(<span class="stringliteral">&quot;thit&quot;</span>,   <a class="code" href="classRhopiAlg.html#ab772140290960ca6c561b8f5efe3ac17">fThit</a>);   <span class="comment">// total number of hits</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    log &lt;&lt; MSG::ERROR &lt;&lt; <span class="stringliteral">&quot;    Cannot book N-tuple:&quot;</span> &lt;&lt; long(<a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>) &lt;&lt; endmsg;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    <span class="keywordflow">return</span> StatusCode::FAILURE;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// * NTuple: ToF endcap branch (tofe) * //</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a67fee3f1672e9ae8754235e4d67bcf9a">fCheckTof</a>) {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            NTuplePtr nt8(ntupleSvc(), <span class="stringliteral">&quot;FILE1/tofe&quot;</span>);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="keywordflow">if</span> ( nt8 ) <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a> = nt8;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a> = ntupleSvc()-&gt;book(<span class="stringliteral">&quot;FILE1/tofe&quot;</span>,CLID_ColumnWiseTuple, <span class="stringliteral">&quot;ks N-Tuple example&quot;</span>);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>) {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;ptrk&quot;</span>, <a class="code" href="classRhopiAlg.html#a6bff023a7ad0e81acf00eecf654b6680">fPtotTofEC</a>); <span class="comment">// momentum of the track as reconstructed by MDC</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;path&quot;</span>, <a class="code" href="classRhopiAlg.html#a94afbca13e4703e6e9633d338d126ff2">fPathTofEC</a>); <span class="comment">// path length</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;tof&quot;</span>,  <a class="code" href="classRhopiAlg.html#a41ed043606bdc4cec9defedf436aa81b">fTofEC</a>);  <span class="comment">// time of flight</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;cntr&quot;</span>, <a class="code" href="classRhopiAlg.html#a354696ae96d092f8c3909d7f159f907b">fCntrTofEC</a>); <span class="comment">// ToF counter ID</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;ph&quot;</span>,   <a class="code" href="classRhopiAlg.html#a85df4b2f0fdc23b823a4c31678d4d5c0">fPhTofEC</a>);   <span class="comment">// ToF pulse height</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;rhit&quot;</span>, <a class="code" href="classRhopiAlg.html#a1f3708b502c4dd8befb59d03a2abe921">fRhitTofEC</a>); <span class="comment">// track extrapolate Z or R Hit position</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;qual&quot;</span>, <a class="code" href="classRhopiAlg.html#aa0b82adab74d48f63aa4c684f477fab9">fQualTofEC</a>); <span class="comment">// data quality of reconstruction</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;te&quot;</span>,   <a class="code" href="classRhopiAlg.html#aa75fec796d7f94e51263bb8ccfb6e46d">fElectronTofEC</a>);   <span class="comment">// difference with ToF in electron hypothesis</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;tmu&quot;</span>,  <a class="code" href="classRhopiAlg.html#a35a3bbf454e714b0b1fa8f289a75f4d5">fMuonTofEC</a>);  <span class="comment">// difference with ToF in muon hypothesis</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;tpi&quot;</span>,  <a class="code" href="classRhopiAlg.html#a883806ad7d0da9a3e35538c018b11f36">fProtoniTofEC</a>);  <span class="comment">// difference with ToF in charged pion hypothesis</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;tk&quot;</span>,   <a class="code" href="classRhopiAlg.html#a572a503c110e057b11839a9ea0bffd39">fKaonTofEC</a>);   <span class="comment">// difference with ToF in charged kaon hypothesis</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;addItem(<span class="stringliteral">&quot;tp&quot;</span>,   <a class="code" href="classRhopiAlg.html#a2612daf3658e3fbab560a1e0358c63bb">fProtonTofEC</a>);   <span class="comment">// difference with ToF in proton hypothesis</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    log &lt;&lt; MSG::ERROR &lt;&lt; <span class="stringliteral">&quot;    Cannot book N-tuple:&quot;</span> &lt;&lt; long(<a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>) &lt;&lt; endmsg;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    <span class="keywordflow">return</span> StatusCode::FAILURE;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// * NTuple: TToF inner barrel branch (tof1) * //</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a67fee3f1672e9ae8754235e4d67bcf9a">fCheckTof</a>) {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            NTuplePtr nt9(ntupleSvc(), <span class="stringliteral">&quot;FILE1/tof1&quot;</span>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">if</span> ( nt9 ) <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a> = nt9;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a> = ntupleSvc()-&gt;book(<span class="stringliteral">&quot;FILE1/tof1&quot;</span>, CLID_ColumnWiseTuple, <span class="stringliteral">&quot;ks N-Tuple example&quot;</span>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>) {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;ptrk&quot;</span>, <a class="code" href="classRhopiAlg.html#a638cbad7bd516bac660cbf9098bfb0d5">fPtotTofIB</a>); <span class="comment">// momentum of the track as reconstructed by MDC</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;path&quot;</span>, <a class="code" href="classRhopiAlg.html#af8df43bfaf8fa8fa52ff707ee185c42b">fPathTofIB</a>); <span class="comment">// path length</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;tof&quot;</span>,  <a class="code" href="classRhopiAlg.html#a4070e381f84ed203745d46c27f7560df">fTofIB</a>);  <span class="comment">// time of flight</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;cntr&quot;</span>, <a class="code" href="classRhopiAlg.html#a201daca75693f83f6bfc62aa657927be">fCntrTofIB</a>); <span class="comment">// ToF counter ID</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;ph&quot;</span>,   <a class="code" href="classRhopiAlg.html#acc0bf0b6203903892120e7987e64827b">fPhTofIB</a>);   <span class="comment">// ToF pulse height</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;zhit&quot;</span>, <a class="code" href="classRhopiAlg.html#a7b826bbc65599849e296f249c112a401">fZhitTofIB</a>); <span class="comment">// track extrapolate Z or R Hit position</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;qual&quot;</span>, <a class="code" href="classRhopiAlg.html#a0ff889bcc8308d10ee9a8e94678e96ca">fQualTofIB</a>); <span class="comment">// data quality of reconstruction</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;te&quot;</span>,   <a class="code" href="classRhopiAlg.html#ad6b1109e1db8ae5a1a61df5254f6d56d">fElectronTofIB</a>);   <span class="comment">// difference with ToF in electron hypothesis</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;tmu&quot;</span>,  <a class="code" href="classRhopiAlg.html#a73632dd882bf7c5d743978fa4b940e33">fMuonTofIB</a>);  <span class="comment">// difference with ToF in muon hypothesis</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;tpi&quot;</span>,  <a class="code" href="classRhopiAlg.html#ab6732e46d103fd424a74e25325c41302">fProtoniTofIB</a>);  <span class="comment">// difference with ToF in charged pion hypothesis</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;tk&quot;</span>,   <a class="code" href="classRhopiAlg.html#ae70e62c6743a06c32a6229c09998674f">fKaonTofIB</a>);   <span class="comment">// difference with ToF in charged kaon hypothesis</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                    <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;addItem(<span class="stringliteral">&quot;tp&quot;</span>,   <a class="code" href="classRhopiAlg.html#a98145ec36df7b86c7bcfaf053e23d23b">fProtonTofIB</a>);   <span class="comment">// difference with ToF in proton hypothesis</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    log &lt;&lt; MSG::ERROR &lt;&lt; <span class="stringliteral">&quot;    Cannot book N-tuple:&quot;</span> &lt;&lt; long(<a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>) &lt;&lt; endmsg;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    <span class="keywordflow">return</span> StatusCode::FAILURE;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// * NTuple: check ToF outer barrel branch (tof2) * //</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a67fee3f1672e9ae8754235e4d67bcf9a">fCheckTof</a>) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            NTuplePtr nt10(ntupleSvc(), <span class="stringliteral">&quot;FILE1/tof2&quot;</span>);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">if</span> ( nt10 ) <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a> = nt10;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a> = ntupleSvc()-&gt;book(<span class="stringliteral">&quot;FILE1/tof2&quot;</span>, CLID_ColumnWiseTuple, <span class="stringliteral">&quot;ks N-Tuple example&quot;</span>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;ptrk&quot;</span>, <a class="code" href="classRhopiAlg.html#a3ceff76f3adca90d18069131280ede62">fPtotTofOB</a>); <span class="comment">// momentum of the track as reconstructed by MDC</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;path&quot;</span>, <a class="code" href="classRhopiAlg.html#afa8aac036d2f231159785b3dd8963168">fPathTofOB</a>); <span class="comment">// path length</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;tof&quot;</span>,  <a class="code" href="classRhopiAlg.html#a12b17974c33cd8cab250fe957c3d1dae">fTofOB</a>);  <span class="comment">// time of flight</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;cntr&quot;</span>, <a class="code" href="classRhopiAlg.html#abe7aadfeea34b2d602eac7d84c9a3e45">fCntrTofOB</a>); <span class="comment">// ToF counter ID</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;ph&quot;</span>,   <a class="code" href="classRhopiAlg.html#a50604008aeb7c1eddf622a0e0a535124">fPhTofOB</a>);   <span class="comment">// ToF pulse height</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;zhit&quot;</span>, <a class="code" href="classRhopiAlg.html#a3ba7c0f8a9a7e2a3f5278ab81e9d7647">fZhitTofOB</a>); <span class="comment">// track extrapolate Z or R Hit position</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;qual&quot;</span>, <a class="code" href="classRhopiAlg.html#afc7aa7620209a9b2935d9bbd0dc2e6cc">fQualTofOB</a>); <span class="comment">// data quality of reconstruction</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;te&quot;</span>,   <a class="code" href="classRhopiAlg.html#aa88b5abc128a1e4fa47849489a3825da">fElectronTofOB</a>);   <span class="comment">// difference with ToF in electron hypothesis</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;tmu&quot;</span>,  <a class="code" href="classRhopiAlg.html#a3ca2a92d0d8c010926b8e3eb7758f307">fMuonTofOB</a>);  <span class="comment">// difference with ToF in muon hypothesis</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;tpi&quot;</span>,  <a class="code" href="classRhopiAlg.html#a1ca43015d229652bde1e02036409cb59">fProtoniTofOB</a>);  <span class="comment">// difference with ToF in charged pion hypothesis</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;tk&quot;</span>,   <a class="code" href="classRhopiAlg.html#a5fee8ed7e3d72239c3d288d58910b942">fKaonTofOB</a>);   <span class="comment">// difference with ToF in charged kaon hypothesis</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;addItem(<span class="stringliteral">&quot;tp&quot;</span>,   <a class="code" href="classRhopiAlg.html#a7d203346092c499c4e75ec1d98635eb7">fProtonTofOB</a>);   <span class="comment">// difference with ToF in proton hypothesis</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    log &lt;&lt; MSG::ERROR &lt;&lt; <span class="stringliteral">&quot;    Cannot book N-tuple:&quot;</span> &lt;&lt; long(<a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>) &lt;&lt; endmsg;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    <span class="keywordflow">return</span> StatusCode::FAILURE;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// * NTuple: Track PID information (pid) * //</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        NTuplePtr nt11(ntupleSvc(), <span class="stringliteral">&quot;FILE1/pid&quot;</span>);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span> ( nt11 ) <a class="code" href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">fTuplePID</a> = nt11;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <a class="code" href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">fTuplePID</a> = ntupleSvc()-&gt;book(<span class="stringliteral">&quot;FILE1/pid&quot;</span>, CLID_ColumnWiseTuple, <span class="stringliteral">&quot;ks N-Tuple example&quot;</span>);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">fTuplePID</a>) {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <a class="code" href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">fTuplePID</a>-&gt;addItem(<span class="stringliteral">&quot;ptrk&quot;</span>, <a class="code" href="classRhopiAlg.html#aae6e6a3b9ee4990b06b9707a381edc17">fPtrackPID</a>); <span class="comment">// momentum of the track</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <a class="code" href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">fTuplePID</a>-&gt;addItem(<span class="stringliteral">&quot;cost&quot;</span>, <a class="code" href="classRhopiAlg.html#aa9c7c0701477d8155871115a28b6a0ed">fCostPID</a>); <span class="comment">// theta angle of the track</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <a class="code" href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">fTuplePID</a>-&gt;addItem(<span class="stringliteral">&quot;dedx&quot;</span>, <a class="code" href="classRhopiAlg.html#a624abc570b4263b26674f081b866b90c">fDedxPID</a>); <span class="comment">// Chi2 of the dedx of the track</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <a class="code" href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">fTuplePID</a>-&gt;addItem(<span class="stringliteral">&quot;tof1&quot;</span>, <a class="code" href="classRhopiAlg.html#ac860765c5d5011e18e96c88dbe1d8152">fTof1PID</a>); <span class="comment">// Chi2 of the inner barrel ToF of the track</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <a class="code" href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">fTuplePID</a>-&gt;addItem(<span class="stringliteral">&quot;tof2&quot;</span>, <a class="code" href="classRhopiAlg.html#a951684079e1201c940c08406eff4460e">fTof2PID</a>); <span class="comment">// Chi2 of the outer barrel ToF of the track</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <a class="code" href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">fTuplePID</a>-&gt;addItem(<span class="stringliteral">&quot;prob&quot;</span>, <a class="code" href="classRhopiAlg.html#a6f8865d4c73800ce7e8df868aaf30ae9">fProbPID</a>); <span class="comment">// probability that it is a pion</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                log &lt;&lt; MSG::ERROR &lt;&lt; <span class="stringliteral">&quot;    Cannot book N-tuple:&quot;</span> &lt;&lt; long(<a class="code" href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">fTuplePID</a>) &lt;&lt; endmsg;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="keywordflow">return</span> StatusCode::FAILURE;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    log &lt;&lt; MSG::INFO &lt;&lt; <span class="stringliteral">&quot;Successfully returned from initialize()&quot;</span> &lt;&lt; endmsg;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">return</span> StatusCode::SUCCESS;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">// * ========================= * //</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">// * -------- EXECUTE -------- * //</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">// * ========================= * //</span></div><div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="classRhopiAlg.html#a93c6042360744cee6c886ee0ba985504">  368</a></span>&#160;<span class="comment"></span>StatusCode <a class="code" href="classRhopiAlg.html#a93c6042360744cee6c886ee0ba985504">RhopiAlg::execute</a>() {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    MsgStream log(msgSvc(), name());</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    log &lt;&lt; MSG::INFO &lt;&lt; <span class="stringliteral">&quot;In execute():&quot;</span> &lt;&lt; endreq;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// * Load next event from DST file * //</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// NOTE: Ncut0 -- no cut yet</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">// * Load DST file info *</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        SmartDataPtr&lt;Event::EventHeader&gt; eventHeader(eventSvc(), <span class="stringliteral">&quot;/Event/EventHeader&quot;</span>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordtype">int</span> runNo = eventHeader-&gt;runNumber();</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordtype">int</span> evtNo = eventHeader-&gt;eventNumber();</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        log &lt;&lt; MSG::DEBUG &lt;&lt; <span class="stringliteral">&quot;run, evtnum = &quot;</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            &lt;&lt; runNo &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            &lt;&lt; evtNo &lt;&lt; endreq;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;event number: &quot;</span> &lt;&lt; evtNo &lt;&lt; endl;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="RhopiAlg_8cxx.html#a83e267c1596c352aefaeb2c2551d637c">Ncut0</a>++; <span class="comment">// counter for all events</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="comment">// * Load event information and track collection *</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">            http://bes3.to.infn.it/Boss/7.0.2/html/namespaceEventModel_1_1EvtRec.html (namespace)</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">            http://bes3.to.infn.it/Boss/7.0.2/html/classEvtRecEvent.html (class)</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">            http://bes3.to.infn.it/Boss/7.0.2/html/EvtRecTrack_8h.html (typedef EvtRecTrackCol)</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">            */</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        SmartDataPtr&lt;EvtRecEvent&gt;    evtRecEvent (eventSvc(), EventModel::EvtRec::EvtRecEvent);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        SmartDataPtr&lt;EvtRecTrackCol&gt; evtRecTrkCol(eventSvc(), EventModel::EvtRec::EvtRecTrackCol);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">// * Log number of events *</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        log &lt;&lt; MSG::DEBUG &lt;&lt; <span class="stringliteral">&quot;Ncharged, Nneutral, Ntotal = &quot;</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            &lt;&lt; evtRecEvent-&gt;totalCharged() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            &lt;&lt; evtRecEvent-&gt;totalNeutral() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            &lt;&lt; evtRecEvent-&gt;totalTracks() &lt;&lt; endreq;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// * Set vertex origin * //</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        Hep3Vector xorigin(0,0,0);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        IVertexDbSvc* vtxsvc;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        Gaudi::svcLocator()-&gt;service(<span class="stringliteral">&quot;VertexDbSvc&quot;</span>, vtxsvc);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">if</span>(vtxsvc-&gt;isVertexValid()){</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordtype">double</span>* dbv = vtxsvc-&gt;PrimaryVertex();</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordtype">double</span>* vv = vtxsvc-&gt;SigmaPrimaryVertex();</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="comment">// HepVector dbv = fReader.PrimaryVertex(runNo);</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="comment">// HepVector vv  = fReader.SigmaPrimaryVertex(runNo);</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            xorigin.setX(dbv[0]);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            xorigin.setY(dbv[1]);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            xorigin.setZ(dbv[2]);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// * LOOP OVER CHARGED TRACKS: select charged tracks (eventual pions) * //</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// NOTE: Ncut1 -- nGood has to be 2, mdcTrk-&gt;charge() has to be more than 0</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment">// The first part of the set of reconstructed tracks are the charged tracks</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordtype">int</span> nCharge = 0;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="DzeroOmega_8cxx.html#ae2aff2e5ed6ce2ac4391bedb93e0a615">Vint</a> iGood;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; evtRecEvent-&gt;totalCharged(); ++i) {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="comment">// * Get track: beginning of all tracks + event number</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            EvtRecTrackIterator itTrk = evtRecTrkCol-&gt;begin() + i; </div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordflow">if</span>(!(*itTrk)-&gt;isMdcTrackValid()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="comment">// * Get track info from Main Drift Chamber</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            RecMdcTrack *mdcTrk = (*itTrk)-&gt;mdcTrack();</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordtype">double</span> pch  = mdcTrk-&gt;p();</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordtype">double</span> x0   = mdcTrk-&gt;x();</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="keywordtype">double</span> y0   = mdcTrk-&gt;y();</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordtype">double</span> z0   = mdcTrk-&gt;z();</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="keywordtype">double</span> phi0 = mdcTrk-&gt;helix(1);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="comment">// * Get vertex origin</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordtype">double</span> xv   = xorigin.x();</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordtype">double</span> yv   = xorigin.y();</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordtype">double</span> Rxy  = (x0-xv)*cos(phi0)+(y0-yv)*sin(phi0);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="comment">// * Get radii of vertex</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            HepVector a = mdcTrk-&gt;helix();</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            HepSymMatrix Ea = mdcTrk-&gt;err();</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <a class="code" href="DzeroOmega_8cxx.html#a188faf2fae63125a32fe38f0567026bc">HepPoint3D</a> point0(0.,0.,0.); <span class="comment">// the initial point for MDC recosntruction</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <a class="code" href="DzeroOmega_8cxx.html#a188faf2fae63125a32fe38f0567026bc">HepPoint3D</a> IP(xorigin[0],xorigin[1],xorigin[2]);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            VFHelix helixip(point0,a,Ea);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            helixip.pivot(IP);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            HepVector vecipa = helixip.a();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordtype">double</span> Rvxy0  = fabs(vecipa[0]); <span class="comment">// nearest distance to IP in xy plane</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordtype">double</span> Rvz0   = vecipa[3];       <span class="comment">// nearest distance to IP in z direction</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordtype">double</span> Rvphi0 = vecipa[1];</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="comment">// * WRITE primary vertex position info (&quot;vxyz&quot; branch) *</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <a class="code" href="classRhopiAlg.html#a843b32c7856026e97d87b7566dcec4de">fVx0</a>    = x0;     <span class="comment">// primary x-vertex as determined by MDC</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <a class="code" href="classRhopiAlg.html#a24d545fdc4dcc0bd351ced7527104445">fVy0</a>    = y0;     <span class="comment">// primary y-vertex as determined by MDC</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <a class="code" href="classRhopiAlg.html#a2cd6ce4caafc790e99087214fb6a4e08">fVz0</a>    = z0;     <span class="comment">// primary z-vertex as determined by MDC</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <a class="code" href="classRhopiAlg.html#a476a80614bc98f956f3f4e85c09184e6">fVr0</a>    = Rxy;    <span class="comment">// distance from origin in xy-plane</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <a class="code" href="classRhopiAlg.html#a383964930e74fe9fc4f3bacde18b3423">fRvxy0</a>  = Rvxy0;  <span class="comment">// nearest distance to IP in xy plane</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <a class="code" href="classRhopiAlg.html#a8e349c1966478c78c8489c9d9e5a826b">fRvz0</a>   = Rvz0;   <span class="comment">// nearest distance to IP in z direction</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <a class="code" href="classRhopiAlg.html#a104623b8329459f4a38b3d2b967f27c2">fRvphi0</a> = Rvphi0; <span class="comment">// angle in the xy-plane (?)</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <a class="code" href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">fTupleVxyz</a>-&gt;write(); <span class="comment">// &quot;vxyz&quot; branch</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="comment">// * Apply vertex cuts *</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordflow">if</span>(fabs(z0)    &gt;= <a class="code" href="classRhopiAlg.html#adaa4db6028d5fcada93dc8070152c1ed">fVz0cut</a>)   <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keywordflow">if</span>(fabs(Rxy)   &gt;= <a class="code" href="classRhopiAlg.html#a1dae4ef59a4492c62a8255a169251e3c">fVr0cut</a>)   <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordflow">if</span>(fabs(Rvz0)  &gt;= <a class="code" href="classRhopiAlg.html#a9de83fa5c1b9f04c43c833732acdaea7">fRvz0cut</a>)  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordflow">if</span>(fabs(Rvxy0) &gt;= <a class="code" href="classRhopiAlg.html#aceb706c5131c32c60ebccff68f7c5400">fRvxy0cut</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="comment">// * Add charged track to vector *</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            iGood.push_back(i);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            nCharge += mdcTrk-&gt;charge();</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="comment">// * Finish Good Charged Track Selection * //</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordtype">int</span> nGood = iGood.size();</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        log &lt;&lt; MSG::DEBUG &lt;&lt; <span class="stringliteral">&quot;ngood, totcharge = &quot;</span> &lt;&lt; nGood &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; nCharge &lt;&lt; endreq;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">if</span>((nGood != 2)||(nCharge!=0)){</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">return</span> StatusCode::SUCCESS;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="RhopiAlg_8cxx.html#a4506054600e8230d869ac3c51e807f3a">Ncut1</a>++; <span class="comment">// nGood!=2 or nCharge!=0</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// * LOOP OVER NEUTRAL TRACKS: select photons * //</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// NOTE: Ncut2 -- number of good photons has to be 2 at least</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="comment">// The second part of the set of reconstructed events consists of the neutral tracks, that is, the photons detected by the EMC (by clustering EMC crystal energies). Each neutral track is paired with each charged track and if their angle is smaller than a certain value (here, 200), the photon track is stored as &#39;good photon&#39; (added to `iGam`).</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <a class="code" href="DzeroOmega_8cxx.html#ae2aff2e5ed6ce2ac4391bedb93e0a615">Vint</a> iGam;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = evtRecEvent-&gt;totalCharged(); i &lt; evtRecEvent-&gt;totalTracks(); ++i) {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="comment">// * Get track</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            EvtRecTrackIterator itTrk = evtRecTrkCol-&gt;begin() + i;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="keywordflow">if</span>(!(*itTrk)-&gt;isEmcShowerValid()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            RecEmcShower *emcTrk = (*itTrk)-&gt;emcShower();</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            Hep3Vector emcpos(emcTrk-&gt;x(), emcTrk-&gt;y(), emcTrk-&gt;z());</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="comment">// * Find the theta, phi, and angle difference with nearest charged track</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="namespaceAnaBranches_1_1photon.html#a37778a99ce76c6c07bad185f7f2e5347">dthe</a> = 200.; <span class="comment">// start value for difference in theta</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="namespaceAnaBranches_1_1photon.html#a10ad76bdd837e440878583517a1e3c05">dphi</a> = 200.; <span class="comment">// start value for difference in phi</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="namespaceAnaBranches_1_1photon.html#a3f37b0e1d44a6d7f210e6fd5ac87e27e">dang</a> = 200.; <span class="comment">// start value for difference in angle (?)</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; evtRecEvent-&gt;totalCharged(); j++) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                EvtRecTrackIterator jtTrk = evtRecTrkCol-&gt;begin() + j;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="keywordflow">if</span>(!(*jtTrk)-&gt;isExtTrackValid()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                RecExtTrack *extTrk = (*jtTrk)-&gt;extTrack();</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <span class="keywordflow">if</span>(extTrk-&gt;emcVolumeNumber() == -1) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                Hep3Vector extpos = extTrk-&gt;emcPosition();</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <span class="comment">// double ctht = extpos.cosTheta(emcpos);</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                <span class="keywordtype">double</span> angd = extpos.angle(emcpos);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                <span class="keywordtype">double</span> thed = extpos.theta() - emcpos.theta();</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="keywordtype">double</span> phid = extpos.deltaPhi(emcpos);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                thed = fmod(thed + CLHEP::twopi + CLHEP::twopi + pi, CLHEP::twopi) - CLHEP::pi;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                phid = fmod(phid + CLHEP::twopi + CLHEP::twopi + pi, CLHEP::twopi) - CLHEP::pi;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                <span class="keywordflow">if</span>(angd &lt; dang){</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    dang = angd;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    dthe = thed;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    dphi = phid;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="comment">// * Apply angle cut</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">if</span>(dang&gt;=200) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="namespaceAnaBranches_1_1photon.html#ac7245a91852725d796bb45be1091078a">eraw</a> = emcTrk-&gt;energy();</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            dthe = dthe * 180 / (CLHEP::pi);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            dphi = dphi * 180 / (CLHEP::pi);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            dang = dang * 180 / (CLHEP::pi);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="comment">// * WRITE photon info (&quot;photon&quot; branch)</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <a class="code" href="classRhopiAlg.html#a759992581423aee745872348f9733ccf">fDeltaTheta</a> = <a class="code" href="namespaceAnaBranches_1_1photon.html#a37778a99ce76c6c07bad185f7f2e5347">dthe</a>; <span class="comment">// theta difference with nearest charged track (degrees)</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <a class="code" href="classRhopiAlg.html#a377fb2c23a974a2bf751176e2a67ee38">fDeltaPhi</a> = <a class="code" href="namespaceAnaBranches_1_1photon.html#a10ad76bdd837e440878583517a1e3c05">dphi</a>; <span class="comment">// phi difference with nearest charged track (degrees)</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <a class="code" href="classRhopiAlg.html#a052ad1d216f1006d00a162f7a2548111">fDeltaAngle</a> = <a class="code" href="namespaceAnaBranches_1_1photon.html#a3f37b0e1d44a6d7f210e6fd5ac87e27e">dang</a>; <span class="comment">// angle difference with nearest charged track</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <a class="code" href="classRhopiAlg.html#a3ad054a1e60f0a8dc4ba3e5ab066b229">fEraw</a> = <a class="code" href="namespaceAnaBranches_1_1photon.html#ac7245a91852725d796bb45be1091078a">eraw</a>; <span class="comment">// energy of the photon</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <a class="code" href="classRhopiAlg.html#a188bc0198dd44ae64e236099f2409c56">fTupleAngles</a>-&gt;write(); <span class="comment">// &quot;photon&quot; branch</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="comment">// * Apply photon cuts</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <span class="keywordflow">if</span>(eraw &lt; <a class="code" href="classRhopiAlg.html#a0ac1cb08a0a7b847b4a50e35dd6a5434">fEnergyThreshold</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keywordflow">if</span>((fabs(dthe) &lt; <a class="code" href="classRhopiAlg.html#ae453281b12586262b1bb4f058ee1e6bf">fGammaThetaCut</a>) &amp;&amp; (fabs(dphi) &lt; <a class="code" href="classRhopiAlg.html#a2c907b2b6d12917ce44b4cf8442738ff">fGammaPhiCut</a>) ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="keywordflow">if</span>(fabs(dang) &lt; <a class="code" href="classRhopiAlg.html#a00972c94ffc8686f548a1597073ae5d8">fGammaAngleCut</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="comment">// * Add photon track to vector</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            iGam.push_back(i);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="comment">// * Finish Good Photon Selection *</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordtype">int</span> nGam = iGam.size();</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        log &lt;&lt; MSG::DEBUG &lt;&lt; <span class="stringliteral">&quot;Number of good photons: &quot;</span> &lt;&lt; nGam &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; evtRecEvent-&gt;totalNeutral() &lt;&lt; endreq;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordflow">if</span>(nGam&lt;2) {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="keywordflow">return</span> StatusCode::SUCCESS;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <a class="code" href="RhopiAlg_8cxx.html#a11b83c587312d370e5ce54dade6d117c">Ncut2</a>++; <span class="comment">// number of photons &lt; 2</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">// * Check charged track dEdx PID information * //</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a611af9831ff29dd16b8d255bbab8268b">fCheckDedx</a>) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nGood; ++i) {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                <span class="comment">// * Get track *</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                EvtRecTrackIterator  itTrk = evtRecTrkCol-&gt;begin() + iGood[i];</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                <span class="keywordflow">if</span>(!(*itTrk)-&gt;isMdcTrackValid()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                <span class="keywordflow">if</span>(!(*itTrk)-&gt;isMdcDedxValid())<span class="keywordflow">continue</span>;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                RecMdcTrack* mdcTrk = (*itTrk)-&gt;mdcTrack();</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                RecMdcDedx* dedxTrk = (*itTrk)-&gt;mdcDedx();</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                <span class="comment">// * WRITE energy loss PID info (&quot;dedx&quot; branch) *</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                <a class="code" href="classRhopiAlg.html#a7318cf3dc4112c5ec68d1c8f963326db">fPtrack</a>   = mdcTrk-&gt;p();             <span class="comment">// momentum of the track</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                <a class="code" href="classRhopiAlg.html#aab7b47430f7eb3fcc1e74b0c8b6c4fcf">fChi2e</a>   = dedxTrk-&gt;chiE();         <span class="comment">// chi2 in case of electron</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                <a class="code" href="classRhopiAlg.html#a64a48c1045ed925d010badcafc28ddfd">fChi2mu</a>  = dedxTrk-&gt;chiMu();        <span class="comment">// chi2 in case of muon</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                <a class="code" href="classRhopiAlg.html#a4f698122f565c49a9c12934078eb1f64">fChi2pi</a>  = dedxTrk-&gt;chiPi();        <span class="comment">// chi2 in case of pion</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                <a class="code" href="classRhopiAlg.html#a1b65a274eaffc58ed048746eb3e446ff">fChi2k</a>   = dedxTrk-&gt;chiK();         <span class="comment">// chi2 in case of kaon</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <a class="code" href="classRhopiAlg.html#af36844ec30aa092b60451a65f2abbfc1">fChi2p</a>   = dedxTrk-&gt;chiP();         <span class="comment">// chi2 in case of proton</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <a class="code" href="classRhopiAlg.html#aebb4764f43dc107037bbafc4cc5ba07f">fProbPH</a> = dedxTrk-&gt;probPH();       <span class="comment">// most probable pulse height from truncated mean</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                <a class="code" href="classRhopiAlg.html#a2104747b628e5e2ca62eea29eab08257">fNormPH</a> = dedxTrk-&gt;normPH();       <span class="comment">// normalized pulse height</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                <a class="code" href="classRhopiAlg.html#a33d8b54f4c89d710b9a3f3c9512c2cf2">fGhit</a>   = dedxTrk-&gt;numGoodHits();  <span class="comment">// number of good hits</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                <a class="code" href="classRhopiAlg.html#ab772140290960ca6c561b8f5efe3ac17">fThit</a>   = dedxTrk-&gt;numTotalHits(); <span class="comment">// total number of hits</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                <a class="code" href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">fTupleDedx</a>-&gt;write(); <span class="comment">// &quot;dedx&quot; branch</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">// * Check charged track ToF PID information * //</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a67fee3f1672e9ae8754235e4d67bcf9a">fCheckTof</a>) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nGood; ++i) {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                EvtRecTrackIterator  itTrk = evtRecTrkCol-&gt;begin() + iGood[i];</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                <span class="keywordflow">if</span>(!(*itTrk)-&gt;isMdcTrackValid()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <span class="keywordflow">if</span>(!(*itTrk)-&gt;isTofTrackValid()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                RecMdcTrack * mdcTrk = (*itTrk)-&gt;mdcTrack();</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                SmartRefVector&lt;RecTofTrack&gt; tofTrkCol = (*itTrk)-&gt;tofTrack();</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1dedx.html#ac3027e8051061d346762f017795ae4f7">ptrk</a> = mdcTrk-&gt;p();</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                SmartRefVector&lt;RecTofTrack&gt;::iterator iter_tof = tofTrkCol.begin();</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                <span class="keywordflow">for</span>(;iter_tof != tofTrkCol.end(); ++iter_tof) {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                    TofHitStatus hitStatus;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                    hitStatus.setStatus((*iter_tof)-&gt;status());</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                    <span class="comment">// * If end cap ToF detector: *</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                    <span class="keywordflow">if</span>(!(hitStatus.is_barrel())) {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                        <span class="comment">// *  *</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                        <span class="keywordflow">if</span>( !(hitStatus.is_counter()) ) <span class="keywordflow">continue</span>; <span class="comment">// ?</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                        <span class="keywordflow">if</span>(hitStatus.layer() != 0) <span class="keywordflow">continue</span>; <span class="comment">// abort if not end cap</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                        <span class="comment">// * Get ToF info *</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                        <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a3b30c061bb9ddc7c2d680e512438818f">path</a> = (*iter_tof)-&gt;path();       <span class="comment">// distance of flight</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                        <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab9b9a05e835fbf9e06c84107e988ce28">tof</a>  = (*iter_tof)-&gt;tof();        <span class="comment">// time of flight</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                        <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab22fccdebfb2fbafc8ec06367ea23603">ph</a>   = (*iter_tof)-&gt;ph();         <span class="comment">// ToF pulse height</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                        <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#af373be79b614efa509c3a7150ec4ddba">rhit</a> = (*iter_tof)-&gt;zrhit();      <span class="comment">// Track extrapolate Z or R Hit position</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ae7d336c993e92a76ab4cb8d4e0e5046b">qual</a> = 0.+(*iter_tof)-&gt;quality(); <span class="comment">// data quality of reconstruction</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                        <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a61a18bf0093fe8fea91c32a0a91fee9e">cntr</a> = 0.+(*iter_tof)-&gt;tofID();   <span class="comment">// ToF counter ID</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                        <span class="comment">// * Get ToF for each particle hypothesis *</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                        <span class="keywordtype">double</span> texp[5];</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; 5; j++) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                            <span class="keywordtype">double</span> gb = ptrk/<a class="code" href="RhopiAlg_8cxx.html#a850891ce5a4a85d92f96c37288dc134a">xmass</a>[j]; <span class="comment">// v = p/m (non-relativistic velocity)</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                            <span class="keywordtype">double</span> beta = gb/sqrt(1+gb*gb);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                            texp[j] = 10 * path /beta/<a class="code" href="RhopiAlg_8cxx.html#aa99b02ee88055b799a547ebf230ed310">velc_mm</a>; <span class="comment">// hypothesis ToF</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                        }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                        <span class="comment">// * WRITE ToF end cap info (&quot;tofe&quot; branch) *</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        <a class="code" href="classRhopiAlg.html#a6bff023a7ad0e81acf00eecf654b6680">fPtotTofEC</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1dedx.html#ac3027e8051061d346762f017795ae4f7">ptrk</a>;          <span class="comment">// momentum of the track as reconstructed by MDC</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                        <a class="code" href="classRhopiAlg.html#a94afbca13e4703e6e9633d338d126ff2">fPathTofEC</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a3b30c061bb9ddc7c2d680e512438818f">path</a>;          <span class="comment">// path length</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                        <a class="code" href="classRhopiAlg.html#a41ed043606bdc4cec9defedf436aa81b">fTofEC</a>  = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab9b9a05e835fbf9e06c84107e988ce28">tof</a>;           <span class="comment">// time of flight</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                        <a class="code" href="classRhopiAlg.html#a354696ae96d092f8c3909d7f159f907b">fCntrTofEC</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a61a18bf0093fe8fea91c32a0a91fee9e">cntr</a>;          <span class="comment">// ToF counter ID</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                        <a class="code" href="classRhopiAlg.html#a85df4b2f0fdc23b823a4c31678d4d5c0">fPhTofEC</a>   = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab22fccdebfb2fbafc8ec06367ea23603">ph</a>;            <span class="comment">// ToF pulse height</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        <a class="code" href="classRhopiAlg.html#a1f3708b502c4dd8befb59d03a2abe921">fRhitTofEC</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#af373be79b614efa509c3a7150ec4ddba">rhit</a>;          <span class="comment">// track extrapolate Z or R Hit position</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                        <a class="code" href="classRhopiAlg.html#aa0b82adab74d48f63aa4c684f477fab9">fQualTofEC</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ae7d336c993e92a76ab4cb8d4e0e5046b">qual</a>;          <span class="comment">// data quality of reconstruction</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        <a class="code" href="classRhopiAlg.html#aa75fec796d7f94e51263bb8ccfb6e46d">fElectronTofEC</a>   = tof - texp[0]; <span class="comment">// difference with ToF in electron hypothesis</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                        <a class="code" href="classRhopiAlg.html#a35a3bbf454e714b0b1fa8f289a75f4d5">fMuonTofEC</a>  = tof - texp[1]; <span class="comment">// difference with ToF in muon hypothesis</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        <a class="code" href="classRhopiAlg.html#a883806ad7d0da9a3e35538c018b11f36">fProtoniTofEC</a>  = tof - texp[2]; <span class="comment">// difference with ToF in charged pion hypothesis</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                        <a class="code" href="classRhopiAlg.html#a572a503c110e057b11839a9ea0bffd39">fKaonTofEC</a>   = tof - texp[3]; <span class="comment">// difference with ToF in charged kaon hypothesis</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                        <a class="code" href="classRhopiAlg.html#a2612daf3658e3fbab560a1e0358c63bb">fProtonTofEC</a>   = tof - texp[4]; <span class="comment">// difference with ToF in proton hypothesis</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                        <a class="code" href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">fTupleTofEC</a>-&gt;write(); <span class="comment">// &quot;tofe&quot; branch</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                    }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                    <span class="comment">// * If ebarrel ToF ToF detector: *</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                        <span class="keywordflow">if</span>(!hitStatus.is_counter()) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                        <span class="keywordflow">if</span>(hitStatus.layer() == 1) { <span class="comment">// * inner barrel ToF detector</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a3b30c061bb9ddc7c2d680e512438818f">path</a> = (*iter_tof)-&gt;path();       <span class="comment">// distance of flight</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab9b9a05e835fbf9e06c84107e988ce28">tof</a>  = (*iter_tof)-&gt;tof();        <span class="comment">// time of flight</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab22fccdebfb2fbafc8ec06367ea23603">ph</a>   = (*iter_tof)-&gt;ph();         <span class="comment">// ToF pulse height</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#af373be79b614efa509c3a7150ec4ddba">rhit</a> = (*iter_tof)-&gt;zrhit();      <span class="comment">// Track extrapolate Z or R Hit position</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ae7d336c993e92a76ab4cb8d4e0e5046b">qual</a> = 0.+(*iter_tof)-&gt;quality(); <span class="comment">// data quality of reconstruction</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a61a18bf0093fe8fea91c32a0a91fee9e">cntr</a> = 0.+(*iter_tof)-&gt;tofID();   <span class="comment">// ToF counter ID</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                            <span class="keywordtype">double</span> texp[5];</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; 5; j++) {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                <span class="keywordtype">double</span> gb = ptrk/<a class="code" href="RhopiAlg_8cxx.html#a850891ce5a4a85d92f96c37288dc134a">xmass</a>[j]; <span class="comment">// v = p/m (non-relativistic velocity)</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                                <span class="keywordtype">double</span> beta = gb/sqrt(1+gb*gb);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                texp[j] = 10 * path /beta/<a class="code" href="RhopiAlg_8cxx.html#aa99b02ee88055b799a547ebf230ed310">velc_mm</a>; <span class="comment">// hypothesis ToF</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                            }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                            <span class="comment">// * WRITE ToF inner barrel info (&quot;tof1&quot; branch) *</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                            <a class="code" href="classRhopiAlg.html#a638cbad7bd516bac660cbf9098bfb0d5">fPtotTofIB</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1dedx.html#ac3027e8051061d346762f017795ae4f7">ptrk</a>;          <span class="comment">// momentum of the track as reconstructed by MDC</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                            <a class="code" href="classRhopiAlg.html#af8df43bfaf8fa8fa52ff707ee185c42b">fPathTofIB</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a3b30c061bb9ddc7c2d680e512438818f">path</a>;          <span class="comment">// path length</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                            <a class="code" href="classRhopiAlg.html#a4070e381f84ed203745d46c27f7560df">fTofIB</a>  = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab9b9a05e835fbf9e06c84107e988ce28">tof</a>;           <span class="comment">// time of flight</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                            <a class="code" href="classRhopiAlg.html#a201daca75693f83f6bfc62aa657927be">fCntrTofIB</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a61a18bf0093fe8fea91c32a0a91fee9e">cntr</a>;          <span class="comment">// ToF counter ID</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                            <a class="code" href="classRhopiAlg.html#acc0bf0b6203903892120e7987e64827b">fPhTofIB</a>   = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab22fccdebfb2fbafc8ec06367ea23603">ph</a>;            <span class="comment">// ToF pulse height</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                            <a class="code" href="classRhopiAlg.html#a7b826bbc65599849e296f249c112a401">fZhitTofIB</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#af373be79b614efa509c3a7150ec4ddba">rhit</a>;          <span class="comment">// track extrapolate Z or R Hit position</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                            <a class="code" href="classRhopiAlg.html#a0ff889bcc8308d10ee9a8e94678e96ca">fQualTofIB</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ae7d336c993e92a76ab4cb8d4e0e5046b">qual</a>;          <span class="comment">// data quality of reconstruction</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                            <a class="code" href="classRhopiAlg.html#ad6b1109e1db8ae5a1a61df5254f6d56d">fElectronTofIB</a>   = tof - texp[0]; <span class="comment">// difference with ToF in electron hypothesis</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                            <a class="code" href="classRhopiAlg.html#a73632dd882bf7c5d743978fa4b940e33">fMuonTofIB</a>  = tof - texp[1]; <span class="comment">// difference with ToF in muon hypothesis</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                            <a class="code" href="classRhopiAlg.html#ab6732e46d103fd424a74e25325c41302">fProtoniTofIB</a>  = tof - texp[2]; <span class="comment">// difference with ToF in charged pion hypothesis</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                            <a class="code" href="classRhopiAlg.html#ae70e62c6743a06c32a6229c09998674f">fKaonTofIB</a>   = tof - texp[3]; <span class="comment">// difference with ToF in charged kaon hypothesis</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                            <a class="code" href="classRhopiAlg.html#a98145ec36df7b86c7bcfaf053e23d23b">fProtonTofIB</a>   = tof - texp[4]; <span class="comment">// difference with ToF in proton hypothesis</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                            <a class="code" href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">TupleTofIB</a>-&gt;write(); <span class="comment">// &quot;tof1&quot; branch</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                        }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                        <span class="keywordflow">if</span>(hitStatus.layer() == 2) { <span class="comment">// * outer barrel ToF detector</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a3b30c061bb9ddc7c2d680e512438818f">path</a> = (*iter_tof)-&gt;path();       <span class="comment">// distance of flight</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab9b9a05e835fbf9e06c84107e988ce28">tof</a>  = (*iter_tof)-&gt;tof();        <span class="comment">// ToF pulse height</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab22fccdebfb2fbafc8ec06367ea23603">ph</a>   = (*iter_tof)-&gt;ph();         <span class="comment">// ToF pulse height</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#af373be79b614efa509c3a7150ec4ddba">rhit</a> = (*iter_tof)-&gt;zrhit();      <span class="comment">// track extrapolate Z or R Hit position</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ae7d336c993e92a76ab4cb8d4e0e5046b">qual</a> = 0.+(*iter_tof)-&gt;quality(); <span class="comment">// data quality of reconstruction</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a61a18bf0093fe8fea91c32a0a91fee9e">cntr</a> = 0.+(*iter_tof)-&gt;tofID();   <span class="comment">// ToF counter ID</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                            <span class="keywordtype">double</span> texp[5];</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; 5; j++) {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                <span class="keywordtype">double</span> gb = ptrk/<a class="code" href="RhopiAlg_8cxx.html#a850891ce5a4a85d92f96c37288dc134a">xmass</a>[j]; <span class="comment">// v = p/m (non-relativistic velocity)</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                <span class="keywordtype">double</span> beta = gb/sqrt(1+gb*gb);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                texp[j] = 10 * path/beta/<a class="code" href="RhopiAlg_8cxx.html#aa99b02ee88055b799a547ebf230ed310">velc_mm</a>; <span class="comment">// hypothesis ToF</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                            }</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                            <span class="comment">// * WRITE ToF outer barrel info (&quot;tof2&quot; branch) *</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                            <a class="code" href="classRhopiAlg.html#a3ceff76f3adca90d18069131280ede62">fPtotTofOB</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1dedx.html#ac3027e8051061d346762f017795ae4f7">ptrk</a>;          <span class="comment">// momentum of the track as reconstructed by MDC</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                            <a class="code" href="classRhopiAlg.html#afa8aac036d2f231159785b3dd8963168">fPathTofOB</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a3b30c061bb9ddc7c2d680e512438818f">path</a>;          <span class="comment">// path length</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                            <a class="code" href="classRhopiAlg.html#a12b17974c33cd8cab250fe957c3d1dae">fTofOB</a>  = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab9b9a05e835fbf9e06c84107e988ce28">tof</a>;           <span class="comment">// time of flight</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                            <a class="code" href="classRhopiAlg.html#abe7aadfeea34b2d602eac7d84c9a3e45">fCntrTofOB</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#a61a18bf0093fe8fea91c32a0a91fee9e">cntr</a>;          <span class="comment">// ToF counter ID</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                            <a class="code" href="classRhopiAlg.html#a50604008aeb7c1eddf622a0e0a535124">fPhTofOB</a>   = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ab22fccdebfb2fbafc8ec06367ea23603">ph</a>;            <span class="comment">// ToF pulse height</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                            <a class="code" href="classRhopiAlg.html#a3ba7c0f8a9a7e2a3f5278ab81e9d7647">fZhitTofOB</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#af373be79b614efa509c3a7150ec4ddba">rhit</a>;          <span class="comment">// track extrapolate Z or R Hit position</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                            <a class="code" href="classRhopiAlg.html#afc7aa7620209a9b2935d9bbd0dc2e6cc">fQualTofOB</a> = <a class="code" href="namespaceDzeroPhiBranches_1_1tofe.html#ae7d336c993e92a76ab4cb8d4e0e5046b">qual</a>;          <span class="comment">// data quality of reconstruction</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                            <a class="code" href="classRhopiAlg.html#aa88b5abc128a1e4fa47849489a3825da">fElectronTofOB</a>   = tof - texp[0]; <span class="comment">// difference with ToF in electron hypothesis</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                            <a class="code" href="classRhopiAlg.html#a3ca2a92d0d8c010926b8e3eb7758f307">fMuonTofOB</a>  = tof - texp[1]; <span class="comment">// difference with ToF in muon hypothesis</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                            <a class="code" href="classRhopiAlg.html#a1ca43015d229652bde1e02036409cb59">fProtoniTofOB</a>  = tof - texp[2]; <span class="comment">// difference with ToF in charged pion hypothesis</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                            <a class="code" href="classRhopiAlg.html#a5fee8ed7e3d72239c3d288d58910b942">fKaonTofOB</a>   = tof - texp[3]; <span class="comment">// difference with ToF in charged kaon hypothesis</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                            <a class="code" href="classRhopiAlg.html#a7d203346092c499c4e75ec1d98635eb7">fProtonTofOB</a>   = tof - texp[4]; <span class="comment">// difference with ToF in proton hypothesis</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                            <a class="code" href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">TupleTofOB</a>-&gt;write(); <span class="comment">// &quot;tof2&quot; branch</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                        }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            } <span class="comment">// loop all charged track</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// * Get 4-momentum for each photon * //</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <a class="code" href="DzeroOmega_8cxx.html#a66098539bec38058a3d9032d53cbd7ec">Vp4</a> pGam;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nGam; ++i) {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            EvtRecTrackIterator itTrk = evtRecTrkCol-&gt;begin() + iGam[i];</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            RecEmcShower* emcTrk = (*itTrk)-&gt;emcShower();</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="namespaceAnaBranches_1_1photon.html#ac7245a91852725d796bb45be1091078a">eraw</a> = emcTrk-&gt;energy();</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1vxyz.html#ab07d58f450ed9b395ce0a71ddc4edb0c">phi</a> = emcTrk-&gt;phi();</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            <span class="keywordtype">double</span> the = emcTrk-&gt;theta();</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            HepLorentzVector <a class="code" href="namespaceDzeroPhiBranches_1_1dedx.html#ac3027e8051061d346762f017795ae4f7">ptrk</a>;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            ptrk.setPx(eraw*sin(the)*cos(phi));</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            ptrk.setPy(eraw*sin(the)*sin(phi));</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            ptrk.setPz(eraw*cos(the));</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            ptrk.setE(eraw);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <span class="comment">// ptrk = ptrk.boost(-0.011, 0, 0); // boost to cms</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            pGam.push_back(ptrk);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        }</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="comment">// cout &lt;&lt; &quot;before pid&quot; &lt;&lt; endl;</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="comment">// * Get 4-momentum for each charged track * //</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <a class="code" href="DzeroOmega_8cxx.html#ae2aff2e5ed6ce2ac4391bedb93e0a615">Vint</a> ipip, ipim; <span class="comment">// vector of number of good tracks</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <a class="code" href="DzeroOmega_8cxx.html#a66098539bec38058a3d9032d53cbd7ec">Vp4</a>  ppip, ppim; <span class="comment">// vector of momenta</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        ParticleID *pid = ParticleID::instance();</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nGood; ++i) {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            EvtRecTrackIterator itTrk = evtRecTrkCol-&gt;begin() + iGood[i];</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="comment">// if(pid) delete pid;</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            pid-&gt;init();</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            pid-&gt;setMethod(pid-&gt;methodProbability());</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="comment">// pid-&gt;setMethod(pid-&gt;methodLikelihood()); // for Likelihood Method</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            pid-&gt;setChiMinCut(4);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            pid-&gt;setRecTrack(*itTrk);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            pid-&gt;usePidSys(pid-&gt;useDedx() | pid-&gt;useTof1() | pid-&gt;useTof2() | pid-&gt;useTofE()); <span class="comment">// use PID sub-system</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            pid-&gt;identify(pid-&gt;onlyPion() | pid-&gt;onlyKaon()); <span class="comment">// seperater Pion/Kaon</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <span class="comment">// pid-&gt;identify(pid-&gt;onlyPion());</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="comment">// pid-&gt;identify(pid-&gt;onlyKaon());</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            pid-&gt;calculate();</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="keywordflow">if</span>(!(pid-&gt;IsPidInfoValid())) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            RecMdcTrack* mdcTrk = (*itTrk)-&gt;mdcTrack();</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="comment">// * WRITE particle identification info (&quot;pid&quot; branch) *</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <a class="code" href="classRhopiAlg.html#aae6e6a3b9ee4990b06b9707a381edc17">fPtrackPID</a> = mdcTrk-&gt;p();          <span class="comment">// momentum of the track</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <a class="code" href="classRhopiAlg.html#aa9c7c0701477d8155871115a28b6a0ed">fCostPID</a> = cos(mdcTrk-&gt;theta()); <span class="comment">// theta angle of the track</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <a class="code" href="classRhopiAlg.html#a624abc570b4263b26674f081b866b90c">fDedxPID</a> = pid-&gt;chiDedx(2);      <span class="comment">// Chi squared of the dedx of the track</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <a class="code" href="classRhopiAlg.html#ac860765c5d5011e18e96c88dbe1d8152">fTof1PID</a> = pid-&gt;chiTof1(2);      <span class="comment">// Chi squared of the inner barrel ToF of the track</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <a class="code" href="classRhopiAlg.html#a951684079e1201c940c08406eff4460e">fTof2PID</a> = pid-&gt;chiTof2(2);      <span class="comment">// Chi squared of the outer barrel ToF of the track</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <a class="code" href="classRhopiAlg.html#a6f8865d4c73800ce7e8df868aaf30ae9">fProbPID</a> = pid-&gt;probPion();      <span class="comment">// probability that it is a pion</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <a class="code" href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">fTuplePID</a>-&gt;write(); <span class="comment">// &quot;pid&quot; branch</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <span class="keywordflow">if</span>(pid-&gt;probPion() &lt; 0.001 || (pid-&gt;probPion() &lt; pid-&gt;probKaon())) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <span class="keywordflow">if</span>(pid-&gt;probPion() &lt; 0.001) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordflow">if</span>(pid-&gt;pdf(2)&lt;pid-&gt;pdf(3)) <span class="keywordflow">continue</span>; <span class="comment">// for Likelihood Method (0=electron 1=muon 2=pion 3=kaon 4=proton)</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            RecMdcKalTrack* mdcKalTrk = (*itTrk)-&gt;mdcKalTrack(); <span class="comment">// After ParticleID, use RecMdcKalTrack substitute RecMdcTrack</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            RecMdcKalTrack::setPidType(RecMdcKalTrack::pion); <span class="comment">// PID can set to electron, muon, pion, kaon and proton;The default setting is pion</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="keywordflow">if</span>(mdcKalTrk-&gt;charge() &gt;0) {</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                ipip.push_back(iGood[i]);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                HepLorentzVector <a class="code" href="namespaceDzeroPhiBranches_1_1dedx.html#ac3027e8051061d346762f017795ae4f7">ptrk</a>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                ptrk.setPx(mdcKalTrk-&gt;px());</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                ptrk.setPy(mdcKalTrk-&gt;py());</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                ptrk.setPz(mdcKalTrk-&gt;pz());</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="keywordtype">double</span> p3 = ptrk.mag();</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                ptrk.setE(sqrt(p3*p3+<a class="code" href="RhopiAlg_8cxx.html#ab7b35acf658c14d92b5b892a4fa74761">mpi0</a>*<a class="code" href="RhopiAlg_8cxx.html#ab7b35acf658c14d92b5b892a4fa74761">mpi0</a>));</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                <span class="comment">// ptrk = ptrk.boost(-0.011,0,0); // boost to cms</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                ppip.push_back(ptrk);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                ipim.push_back(iGood[i]);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                HepLorentzVector <a class="code" href="namespaceDzeroPhiBranches_1_1dedx.html#ac3027e8051061d346762f017795ae4f7">ptrk</a>;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                ptrk.setPx(mdcKalTrk-&gt;px());</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                ptrk.setPy(mdcKalTrk-&gt;py());</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                ptrk.setPz(mdcKalTrk-&gt;pz());</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="keywordtype">double</span> p3 = ptrk.mag();</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                ptrk.setE(sqrt(p3*p3+<a class="code" href="RhopiAlg_8cxx.html#ab7b35acf658c14d92b5b892a4fa74761">mpi0</a>*<a class="code" href="RhopiAlg_8cxx.html#ab7b35acf658c14d92b5b892a4fa74761">mpi0</a>));</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="comment">// ptrk = ptrk.boost(-0.011,0,0); // boost to cms</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                ppim.push_back(ptrk);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">// * RhopiAlg without PID * //</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="comment">// for(int i = 0; i &lt; nGood; ++i) { </span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="comment">// EvtRecTrackIterator itTrk = evtRecTrkCol-&gt;begin() + iGood[i];</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="comment">// RecMdcTrack* mdcTrk = (*itTrk)-&gt;mdcTrack();</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <span class="comment">// if(mdcTrk-&gt;charge() &gt;0) {</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                <span class="comment">// ipip.push_back(iGood[i]);</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                <span class="comment">// HepLorentzVector ptrk;</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                <span class="comment">// ptrk.setPx(mdcTrk-&gt;px());</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                <span class="comment">// ptrk.setPy(mdcTrk-&gt;py());</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <span class="comment">// ptrk.setPz(mdcTrk-&gt;pz());</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                <span class="comment">// double p3 = ptrk.mag();</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                <span class="comment">// ptrk.setE(sqrt(p3*p3+mpi0*mpi0));</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                <span class="comment">// ppip.push_back(ptrk);</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <span class="comment">// } else {</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                <span class="comment">// ipim.push_back(iGood[i]);</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                <span class="comment">// HepLorentzVector ptrk;</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <span class="comment">// ptrk.setPx(mdcTrk-&gt;px());</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <span class="comment">// ptrk.setPy(mdcTrk-&gt;py());</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                <span class="comment">// ptrk.setPz(mdcTrk-&gt;pz());</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                <span class="comment">// double p3 = ptrk.mag();</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                <span class="comment">// ptrk.setE(sqrt(p3*p3+mpi0*mpi0));</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                <span class="comment">// ppim.push_back(ptrk);</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            <span class="comment">// }</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="comment">// } // without PID</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">// NOTE: Ncut3 -- ipip.size() * ipim.size() cannot be 1</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordtype">int</span> npip = ipip.size();</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordtype">int</span> npim = ipim.size();</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">if</span>(npip*npim != 1) <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <a class="code" href="RhopiAlg_8cxx.html#abdd8572dc795b0d4176087cdc0a2bfe1">Ncut3</a>++; <span class="comment">// ipip.size() * ipim.size() cannot be 1</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="comment">// * Loop over each gamma pair and store total energy * //</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        HepLorentzVector pTot;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nGam-1; ++i) {</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = i+1; j &lt; nGam; j++) {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                HepLorentzVector p2g = pGam[i] + pGam[j];</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                pTot = ppip[0] + ppim[0];</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                pTot += p2g;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="comment">// * WRITE total energy and pi^0 candidate inv. mass (&quot;etot&quot; branch) *</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                <a class="code" href="classRhopiAlg.html#a8d07c968212f4b83442f49e254dd2670">fMtoGG</a> = p2g.m();  <span class="comment">// invariant mass of the two gammas</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <a class="code" href="classRhopiAlg.html#a1d88c12fcd397ee20c4f49f5afc68c6d">fEtot</a> = pTot.e(); <span class="comment">// total energy of pi^+, pi^ and the two gammas</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                <a class="code" href="classRhopiAlg.html#a6a7475fe62353cd97e797b6ade82c53b">fTupleMgg</a>-&gt;write(); <span class="comment">// &quot;etot&quot; branch</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        RecMdcKalTrack *pipTrk = (*(evtRecTrkCol-&gt;begin()+ipip[0]))-&gt;mdcKalTrack();</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        RecMdcKalTrack *pimTrk = (*(evtRecTrkCol-&gt;begin()+ipim[0]))-&gt;mdcKalTrack();</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        WTrackParameter wvpipTrk, wvpimTrk;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        wvpipTrk = WTrackParameter(<a class="code" href="RhopiAlg_8cxx.html#ab7b35acf658c14d92b5b892a4fa74761">mpi0</a>, pipTrk-&gt;getZHelix(), pipTrk-&gt;getZError());</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        wvpimTrk = WTrackParameter(<a class="code" href="RhopiAlg_8cxx.html#ab7b35acf658c14d92b5b892a4fa74761">mpi0</a>, pimTrk-&gt;getZHelix(), pimTrk-&gt;getZError());</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">// * Default is pion, for other particles: * //</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="comment">// wvppTrk = WTrackParameter(mp, pipTrk-&gt;getZHelixP(), pipTrk-&gt;getZErrorP()); // proton</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="comment">// wvmupTrk = WTrackParameter(mmu, pipTrk-&gt;getZHelixMu(), pipTrk-&gt;getZErrorMu()); // muon</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="comment">// wvepTrk = WTrackParameter(me, pipTrk-&gt;getZHelixE(), pipTrk-&gt;getZErrorE()); // electron</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="comment">// wvkpTrk = WTrackParameter(mk, pipTrk-&gt;getZHelixK(), pipTrk-&gt;getZErrorK()); // kaon</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="comment">// * Test vertex fit * //</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <a class="code" href="DzeroOmega_8cxx.html#a188faf2fae63125a32fe38f0567026bc">HepPoint3D</a> <a class="code" href="namespaceDzeroPhiBranches_1_1vxyz.html#a17001765d451d0d64eb619ef1321c42f">vx</a>(0., 0., 0.);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        HepSymMatrix Evx(3, 0);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="keywordtype">double</span> bx = 1E+6;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordtype">double</span> by = 1E+6;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordtype">double</span> bz = 1E+6;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        Evx[0][0] = bx*bx;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        Evx[1][1] = by*by;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        Evx[2][2] = bz*bz;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        VertexParameter vxpar;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        vxpar.setVx(vx);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        vxpar.setEvx(Evx);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        VertexFit* vtxfit = VertexFit::instance();</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        vtxfit-&gt;init();</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        vtxfit-&gt;AddTrack(0, wvpipTrk);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        vtxfit-&gt;AddTrack(1, wvpimTrk);</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        vtxfit-&gt;AddVertex(0, vxpar,0, 1);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">if</span>(!vtxfit-&gt;Fit(0)) <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        vtxfit-&gt;Swim(0);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        WTrackParameter wpip = vtxfit-&gt;wtrk(0);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        WTrackParameter wpim = vtxfit-&gt;wtrk(1);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="comment">// KinematicFit * kmfit = KinematicFit::instance();</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        KalmanKinematicFit * kkmfit = KalmanKinematicFit::instance();</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="comment">// * Apply Kalman 4-constrain kinematic fit * //</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a85bfe78eb173354f1755694067deb1a0">fElectronst4C</a>) {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            HepLorentzVector <a class="code" href="DzeroPhi_8cxx.html#a4280a7c0dacc8860173bdd2ffbdb0a3b">ecms</a>(0.034, 0, 0, <a class="code" href="RhopiAlg_8cxx.html#a123ac7871ce3ce2f3ef73eddc6aae85a">Ecms</a>);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <span class="keywordtype">double</span> chisq = 9999.;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <span class="keywordtype">int</span> ig1 = -1;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            <span class="keywordtype">int</span> ig2 = -1;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <span class="comment">// * Run over all gamma pairs and find the pair with the best chi2</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nGam-1; ++i) {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                RecEmcShower *g1Trk = (*(evtRecTrkCol-&gt;begin()+iGam[i]))-&gt;emcShower();</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = i+1; j &lt; nGam; j++) {</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                    RecEmcShower *g2Trk = (*(evtRecTrkCol-&gt;begin()+iGam[j]))-&gt;emcShower();</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                    kkmfit-&gt;init();</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                    kkmfit-&gt;AddTrack(0, wpip);       <span class="comment">// pos. pion</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                    kkmfit-&gt;AddTrack(1, wpim);       <span class="comment">// neg. pion</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                    kkmfit-&gt;AddTrack(2, 0.0, g1Trk); <span class="comment">// first gamma track</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                    kkmfit-&gt;AddTrack(3, 0.0, g2Trk); <span class="comment">// seconnd gamma track</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                    kkmfit-&gt;AddFourMomentum(0, ecms); <span class="comment">// 4 constraints: CMS energy and momentum</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                    <span class="keywordflow">if</span>(kkmfit-&gt;Fit()) {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                        <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1fit4c.html#a52e1b31cb72288523689cfd5590e2c18">chi2</a> = kkmfit-&gt;chisq();</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                        <span class="keywordflow">if</span>(chi2 &lt; chisq) {</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                            chisq = <a class="code" href="namespaceDzeroPhiBranches_1_1fit4c.html#a52e1b31cb72288523689cfd5590e2c18">chi2</a>;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                            ig1 = iGam[i];</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                            ig2 = iGam[j];</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                        }</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                    }</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="comment">// NOTE: Ncut4 -- fit4c passed and ChiSq less than fMaxChiSq</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="keywordflow">if</span>(chisq &lt; <a class="code" href="classRhopiAlg.html#a3879d5b03e9cd0fd30d8f151f930b024">fMaxChiSq</a>) {</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                RecEmcShower *g1Trk = (*(evtRecTrkCol-&gt;begin()+ig1))-&gt;emcShower();</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                RecEmcShower *g2Trk = (*(evtRecTrkCol-&gt;begin()+ig2))-&gt;emcShower();</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                kkmfit-&gt;init();</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                kkmfit-&gt;AddTrack(0, wpip);      <span class="comment">// pos. pion</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                kkmfit-&gt;AddTrack(1, wpim);      <span class="comment">// neg. pion</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                kkmfit-&gt;AddTrack(2, 0., g1Trk); <span class="comment">// first gamma track</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                kkmfit-&gt;AddTrack(3, 0., g2Trk); <span class="comment">// second gamma track</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                kkmfit-&gt;AddFourMomentum(0, ecms); <span class="comment">// 4 constraints: CMS energy and momentum</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                <span class="keywordflow">if</span>(kkmfit-&gt;Fit()) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                    HepLorentzVector ppi0 = kkmfit-&gt;pfit(2) + kkmfit-&gt;pfit(3);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                    <span class="comment">// * WRITE pi^0 information from EMCal (&quot;fit4c&quot; branch) *</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                    <a class="code" href="classRhopiAlg.html#ae291cc82d5644cd4d7224c3fbce754b5">fMpi0</a> = ppi0.m();        <span class="comment">// invariant pi0 mass according to Kalman kinematic fit</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                    <a class="code" href="classRhopiAlg.html#a600c1aa0400ea9d9e5c7226a51978c94">fChi1</a> = kkmfit-&gt;chisq(); <span class="comment">// chi square of the Kalman kinematic fit</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                    <a class="code" href="classRhopiAlg.html#ac9c83f29cbf8dcd882f21e0f41d72ee6">fTupleFit4C</a>-&gt;write(); <span class="comment">// &quot;fit4c&quot; branch</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                    <a class="code" href="RhopiAlg_8cxx.html#afc66a2c95f4c764112c430d34ac53985">Ncut4</a>++; <span class="comment">// ChiSq has to be less than 200 and fit4c has to be passed</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">// * Apply Kalman kinematic fit * //</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// NOTE: Ncut5 -- Kalman kinematic fit 5c is successful</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">// NOTE: Ncut6 -- J/psi -&gt; rho0 pi0 (cut on invariant mass window)</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classRhopiAlg.html#a9a362aa88caa02920d0e8dc7bbb406f1">fElectronst5C</a>) {</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            HepLorentzVector <a class="code" href="DzeroPhi_8cxx.html#a4280a7c0dacc8860173bdd2ffbdb0a3b">ecms</a>(0.034, 0, 0, <a class="code" href="RhopiAlg_8cxx.html#a123ac7871ce3ce2f3ef73eddc6aae85a">Ecms</a>);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <span class="keywordtype">double</span> chisq = 9999.;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <span class="keywordtype">int</span> ig1 = -1;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <span class="keywordtype">int</span> ig2 = -1;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <span class="comment">// * Find the best combination over all possible pi+ pi- gamma gamma pair</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nGam-1; ++i) {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                RecEmcShower *g1Trk = (*(evtRecTrkCol-&gt;begin()+iGam[i]))-&gt;emcShower();</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = i+1; j &lt; nGam; j++) {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                    RecEmcShower *g2Trk = (*(evtRecTrkCol-&gt;begin()+iGam[j]))-&gt;emcShower();</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                    kkmfit-&gt;init();</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                    kkmfit-&gt;AddTrack(0, wpip);            <span class="comment">// pos. pion</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                    kkmfit-&gt;AddTrack(1, wpim);            <span class="comment">// neg. pion</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                    kkmfit-&gt;AddTrack(2, 0., g1Trk);       <span class="comment">// first gamma track</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                    kkmfit-&gt;AddTrack(3, 0., g2Trk);       <span class="comment">// second gamma track</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                    kkmfit-&gt;AddResonance(0, 0.135, 2, 3); <span class="comment">// 5th constraint: pi0 resonance</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                    kkmfit-&gt;AddFourMomentum(1, ecms); <span class="comment">// 4 constraints: CMS energy and momentum</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                    <span class="keywordflow">if</span>(!kkmfit-&gt;Fit(0)) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    <span class="keywordflow">if</span>(!kkmfit-&gt;Fit(1)) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                    <span class="keywordflow">if</span>(kkmfit-&gt;Fit()) {</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                        <span class="keywordtype">double</span> <a class="code" href="namespaceDzeroPhiBranches_1_1fit4c.html#a52e1b31cb72288523689cfd5590e2c18">chi2</a> = kkmfit-&gt;chisq();</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                        <span class="keywordflow">if</span>(chi2 &lt; chisq) {</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                            chisq = <a class="code" href="namespaceDzeroPhiBranches_1_1fit4c.html#a52e1b31cb72288523689cfd5590e2c18">chi2</a>;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                            ig1 = iGam[i];</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                            ig2 = iGam[j];</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                        }</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                    }</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            log &lt;&lt; MSG::INFO &lt;&lt; <span class="stringliteral">&quot; chisq = &quot;</span> &lt;&lt; chisq &lt;&lt; endreq;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="keywordflow">if</span>(chisq &lt; <a class="code" href="classRhopiAlg.html#a3879d5b03e9cd0fd30d8f151f930b024">fMaxChiSq</a>) {</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                RecEmcShower* g1Trk = (*(evtRecTrkCol-&gt;begin()+ig1))-&gt;emcShower();</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                RecEmcShower* g2Trk = (*(evtRecTrkCol-&gt;begin()+ig2))-&gt;emcShower();</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                kkmfit-&gt;init();</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                kkmfit-&gt;AddTrack(0, wpip);            <span class="comment">// pi^+ track</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                kkmfit-&gt;AddTrack(1, wpim);            <span class="comment">// pi^- track</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                kkmfit-&gt;AddTrack(2, 0., g1Trk);       <span class="comment">// first gamma track</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                kkmfit-&gt;AddTrack(3, 0., g2Trk);       <span class="comment">// second gamma track</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                kkmfit-&gt;AddResonance(0, 0.135, 2, 3); <span class="comment">// 5th constraint: pi0 resonance</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                kkmfit-&gt;AddFourMomentum(1, ecms); <span class="comment">// 4 constraints: CMS energy and momentum</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <span class="comment">// * Kalman kinematic fit5c * //</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <span class="keywordflow">if</span>(kkmfit-&gt;Fit()){</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                    HepLorentzVector ppi0  = kkmfit-&gt;pfit(2) + kkmfit-&gt;pfit(3); <span class="comment">// inv. mass Gamma Gamma (pi^0)</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                    HepLorentzVector prho0 = kkmfit-&gt;pfit(0) + kkmfit-&gt;pfit(1); <span class="comment">// inv. mass pi^+ pi^- (rho^0)</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                    HepLorentzVector prhop = ppi0 + kkmfit-&gt;pfit(0);            <span class="comment">// inv. mass pi^0 pi^+ (rho^+)</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                    HepLorentzVector prhom = ppi0 + kkmfit-&gt;pfit(1);            <span class="comment">// inv. mass pi^0 pi^- (rho^-)</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                    <span class="keywordtype">double</span> eg1 = (kkmfit-&gt;pfit(2)).e();</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                    <span class="keywordtype">double</span> eg2 = (kkmfit-&gt;pfit(3)).e();</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                    <span class="keywordtype">double</span> <a class="code" href="namespaceAnaBranches_1_1geff.html#ab1b2038cc91d589656c6027de815734e">fcos</a> = abs(eg1-eg2)/ppi0.rho();</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                    <span class="comment">// * WRITE inv. mass from EMCal info (&quot;fit5c&quot; branch) *</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                    <a class="code" href="classRhopiAlg.html#a866d950f28ee6301700e2cd323033ee3">fChi2</a> = kkmfit-&gt;chisq(); <span class="comment">// chi squared of the Kalman kinematic fit</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                    <a class="code" href="classRhopiAlg.html#a260c4fad9f54ab4a7d326a8177696b99">fMrho0</a> = prho0.m();      <span class="comment">// inv. mass pi^+ pi^- (rho^0)</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                    <a class="code" href="classRhopiAlg.html#aac54be27822ab83575a16ad4b796ad78">fMrhop</a> = prhop.m();      <span class="comment">// inv. mass pi^0 pi^+ (rho^+)</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                    <a class="code" href="classRhopiAlg.html#a624b27fcf9cc3ec90cc6ddf7326f3dc6">fMrhom</a> = prhom.m();      <span class="comment">// inv. mass pi^0 pi^- (rho^-)</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                    <a class="code" href="classRhopiAlg.html#a6f247d2dc0ce778e5986912139bd5ef5">fTupleFit5C</a>-&gt;write(); <span class="comment">// &quot;fit5c&quot; branch</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                    <a class="code" href="RhopiAlg_8cxx.html#a87a44bb9989e7d593d89d0b2b7aa553d">Ncut5</a>++; <span class="comment">// Kalman kinematic fit 5c is successful</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                    <span class="comment">// * Measure the photon detection efficiences via J/psi -&gt; rho0 pi0 * //</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                    <span class="keywordflow">if</span>(fabs(prho0.m() - <a class="code" href="RhopiAlg_8cxx.html#a359fc7286cb3fe45739029aab90fef22">mrho0</a>) &lt; <a class="code" href="classRhopiAlg.html#a2813e7bba4ead1913f5bd883cf475e65">fDeltaMrho0</a>) {</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                        <span class="keywordflow">if</span>(fabs(fcos) &lt; 0.99) {</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                            <span class="comment">// * WRITE photon detection efficiency info (&quot;geff&quot; branch) *</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                            <a class="code" href="classRhopiAlg.html#aaf3f9c4545d1737b04ef0ad329cb37bd">fFcos</a> = (eg1-eg2) / ppi0.rho();  <span class="comment">// E/p ratio for pi^0 candidate</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                            <a class="code" href="classRhopiAlg.html#a62aafbfcb46680e0ea0ed0ff3a5a2c84">fElow</a> = (eg1 &lt; eg2) ? eg1 : eg2; <span class="comment">// lowest energy of the two gammas</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                            <a class="code" href="classRhopiAlg.html#ad6449cfc87feeea89302fb1e8667c7ac">fTuplePhoton</a>-&gt;write(); <span class="comment">// &quot;geff&quot; branch</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                            <a class="code" href="RhopiAlg_8cxx.html#af1d2be22861b1e83a550b9ca430b58cf">Ncut6</a>++; <span class="comment">// 0.620 &lt; mass of rho0 &lt; 0.920</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                        }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                    } <span class="comment">// rho0 cut</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                }</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            }</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        }</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordflow">return</span> StatusCode::SUCCESS;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;}</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">// * ========================== * //</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">// * -------- FINALIZE -------- * //</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">// * ========================== * //</span></div><div class="line"><a name="l01020"></a><span class="lineno"><a class="line" href="classRhopiAlg.html#ab76937e733cff9572d08436bf9236b16"> 1020</a></span>&#160;<span class="comment"></span>StatusCode <a class="code" href="classRhopiAlg.html#ab76937e733cff9572d08436bf9236b16">RhopiAlg::finalize</a>() {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    MsgStream log(msgSvc(), name());</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    log &lt;&lt; MSG::INFO &lt;&lt; <span class="stringliteral">&quot;in finalize()&quot;</span> &lt;&lt; endmsg;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">// * Print flow chart * //</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Resulting FLOW CHART:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  (0) Total number of events: &quot;</span> &lt;&lt; <a class="code" href="RhopiAlg_8cxx.html#a83e267c1596c352aefaeb2c2551d637c">Ncut0</a> &lt;&lt; endl;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  (1) nGood==2, nCharge==0:   &quot;</span> &lt;&lt; <a class="code" href="RhopiAlg_8cxx.html#a4506054600e8230d869ac3c51e807f3a">Ncut1</a> &lt;&lt; endl;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  (2) nGam&gt;=2:                &quot;</span> &lt;&lt; <a class="code" href="RhopiAlg_8cxx.html#a11b83c587312d370e5ce54dade6d117c">Ncut2</a> &lt;&lt; endl;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  (3) Pass PID:               &quot;</span> &lt;&lt; <a class="code" href="RhopiAlg_8cxx.html#abdd8572dc795b0d4176087cdc0a2bfe1">Ncut3</a> &lt;&lt; endl;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  (4) Pass 4C Kalman fit:     &quot;</span> &lt;&lt; <a class="code" href="RhopiAlg_8cxx.html#afc66a2c95f4c764112c430d34ac53985">Ncut4</a> &lt;&lt; endl;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  (5) Pass 5C Kalman fit:     &quot;</span> &lt;&lt; <a class="code" href="RhopiAlg_8cxx.html#a87a44bb9989e7d593d89d0b2b7aa553d">Ncut5</a> &lt;&lt; endl;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  (6) J/psi -&gt; rho0 pi0:      &quot;</span> &lt;&lt; <a class="code" href="RhopiAlg_8cxx.html#af1d2be22861b1e83a550b9ca430b58cf">Ncut6</a> &lt;&lt; endl;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        cout &lt;&lt; endl ;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    log &lt;&lt; MSG::INFO &lt;&lt; <span class="stringliteral">&quot;Successfully returned from finalize()&quot;</span> &lt;&lt; endmsg;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">return</span> StatusCode::SUCCESS;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;}</div><div class="ttc" id="namespaceDzeroPhiBranches_1_1tofe_html_ab9b9a05e835fbf9e06c84107e988ce28"><div class="ttname"><a href="namespaceDzeroPhiBranches_1_1tofe.html#ab9b9a05e835fbf9e06c84107e988ce28">DzeroPhiBranches::tofe::tof</a></div><div class="ttdeci">double tof</div><div class="ttdoc">&lt; Time of Flight end cap branch. </div><div class="ttdef"><b>Definition:</b> <a href="DzeroPhiRootFile_8h_source.html#l00081">DzeroPhiRootFile.h:81</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a3879d5b03e9cd0fd30d8f151f930b024"><div class="ttname"><a href="classRhopiAlg.html#a3879d5b03e9cd0fd30d8f151f930b024">RhopiAlg::fMaxChiSq</a></div><div class="ttdeci">double fMaxChiSq</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00064">RhopiAlg.h:64</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a611af9831ff29dd16b8d255bbab8268b"><div class="ttname"><a href="classRhopiAlg.html#a611af9831ff29dd16b8d255bbab8268b">RhopiAlg::fCheckDedx</a></div><div class="ttdeci">bool fCheckDedx</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00067">RhopiAlg.h:67</a></div></div>
<div class="ttc" id="classRhopiAlg_html_aab7b47430f7eb3fcc1e74b0c8b6c4fcf"><div class="ttname"><a href="classRhopiAlg.html#aab7b47430f7eb3fcc1e74b0c8b6c4fcf">RhopiAlg::fChi2e</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fChi2e</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00117">RhopiAlg.h:117</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_a11b83c587312d370e5ce54dade6d117c"><div class="ttname"><a href="RhopiAlg_8cxx.html#a11b83c587312d370e5ce54dade6d117c">Ncut2</a></div><div class="ttdeci">int Ncut2</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00070">RhopiAlg.cxx:70</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a9de83fa5c1b9f04c43c833732acdaea7"><div class="ttname"><a href="classRhopiAlg.html#a9de83fa5c1b9f04c43c833732acdaea7">RhopiAlg::fRvz0cut</a></div><div class="ttdeci">double fRvz0cut</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00049">RhopiAlg.h:49</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a476a80614bc98f956f3f4e85c09184e6"><div class="ttname"><a href="classRhopiAlg.html#a476a80614bc98f956f3f4e85c09184e6">RhopiAlg::fVr0</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fVr0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00080">RhopiAlg.h:80</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a2612daf3658e3fbab560a1e0358c63bb"><div class="ttname"><a href="classRhopiAlg.html#a2612daf3658e3fbab560a1e0358c63bb">RhopiAlg::fProtonTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fProtonTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00137">RhopiAlg.h:137</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_a359fc7286cb3fe45739029aab90fef22"><div class="ttname"><a href="RhopiAlg_8cxx.html#a359fc7286cb3fe45739029aab90fef22">mrho0</a></div><div class="ttdeci">const double mrho0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00049">RhopiAlg.cxx:49</a></div></div>
<div class="ttc" id="classRhopiAlg_html_abe7aadfeea34b2d602eac7d84c9a3e45"><div class="ttname"><a href="classRhopiAlg.html#abe7aadfeea34b2d602eac7d84c9a3e45">RhopiAlg::fCntrTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fCntrTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00162">RhopiAlg.h:162</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a12b17974c33cd8cab250fe957c3d1dae"><div class="ttname"><a href="classRhopiAlg.html#a12b17974c33cd8cab250fe957c3d1dae">RhopiAlg::fTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00161">RhopiAlg.h:161</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a7d203346092c499c4e75ec1d98635eb7"><div class="ttname"><a href="classRhopiAlg.html#a7d203346092c499c4e75ec1d98635eb7">RhopiAlg::fProtonTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fProtonTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00167">RhopiAlg.h:167</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a0149d09da5a49a1be6eb6a9736db22a9"><div class="ttname"><a href="classRhopiAlg.html#a0149d09da5a49a1be6eb6a9736db22a9">RhopiAlg::fTuplePID</a></div><div class="ttdeci">NTuple::Tuple * fTuplePID</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00173">RhopiAlg.h:173</a></div></div>
<div class="ttc" id="namespaceAnaBranches_1_1photon_html_ac7245a91852725d796bb45be1091078a"><div class="ttname"><a href="namespaceAnaBranches_1_1photon.html#ac7245a91852725d796bb45be1091078a">AnaBranches::photon::eraw</a></div><div class="ttdeci">double eraw</div><div class="ttdoc">Energy of the photon.`. </div><div class="ttdef"><b>Definition:</b> <a href="RhopiRootNamespace_8h_source.html#l00053">RhopiRootNamespace.h:53</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a7318cf3dc4112c5ec68d1c8f963326db"><div class="ttname"><a href="classRhopiAlg.html#a7318cf3dc4112c5ec68d1c8f963326db">RhopiAlg::fPtrack</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fPtrack</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00116">RhopiAlg.h:116</a></div></div>
<div class="ttc" id="namespaceDzeroPhiBranches_1_1tofe_html_a61a18bf0093fe8fea91c32a0a91fee9e"><div class="ttname"><a href="namespaceDzeroPhiBranches_1_1tofe.html#a61a18bf0093fe8fea91c32a0a91fee9e">DzeroPhiBranches::tofe::cntr</a></div><div class="ttdeci">double cntr</div><div class="ttdoc">ToF counter ID. </div><div class="ttdef"><b>Definition:</b> <a href="DzeroPhiRootFile_8h_source.html#l00084">DzeroPhiRootFile.h:84</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a5fee8ed7e3d72239c3d288d58910b942"><div class="ttname"><a href="classRhopiAlg.html#a5fee8ed7e3d72239c3d288d58910b942">RhopiAlg::fKaonTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fKaonTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00166">RhopiAlg.h:166</a></div></div>
<div class="ttc" id="namespaceAnaBranches_1_1photon_html_a10ad76bdd837e440878583517a1e3c05"><div class="ttname"><a href="namespaceAnaBranches_1_1photon.html#a10ad76bdd837e440878583517a1e3c05">AnaBranches::photon::dphi</a></div><div class="ttdeci">double dphi</div><div class="ttdoc">Phi difference with nearest charged track (degrees).`. </div><div class="ttdef"><b>Definition:</b> <a href="RhopiRootNamespace_8h_source.html#l00051">RhopiRootNamespace.h:51</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a9a362aa88caa02920d0e8dc7bbb406f1"><div class="ttname"><a href="classRhopiAlg.html#a9a362aa88caa02920d0e8dc7bbb406f1">RhopiAlg::fElectronst5C</a></div><div class="ttdeci">bool fElectronst5C</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00063">RhopiAlg.h:63</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a1d88c12fcd397ee20c4f49f5afc68c6d"><div class="ttname"><a href="classRhopiAlg.html#a1d88c12fcd397ee20c4f49f5afc68c6d">RhopiAlg::fEtot</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fEtot</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00095">RhopiAlg.h:95</a></div></div>
<div class="ttc" id="classRhopiAlg_html_ad6b1109e1db8ae5a1a61df5254f6d56d"><div class="ttname"><a href="classRhopiAlg.html#ad6b1109e1db8ae5a1a61df5254f6d56d">RhopiAlg::fElectronTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fElectronTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00148">RhopiAlg.h:148</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a354696ae96d092f8c3909d7f159f907b"><div class="ttname"><a href="classRhopiAlg.html#a354696ae96d092f8c3909d7f159f907b">RhopiAlg::fCntrTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fCntrTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00132">RhopiAlg.h:132</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a33d8b54f4c89d710b9a3f3c9512c2cf2"><div class="ttname"><a href="classRhopiAlg.html#a33d8b54f4c89d710b9a3f3c9512c2cf2">RhopiAlg::fGhit</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fGhit</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00124">RhopiAlg.h:124</a></div></div>
<div class="ttc" id="DzeroOmega_8cxx_html_ae2aff2e5ed6ce2ac4391bedb93e0a615"><div class="ttname"><a href="DzeroOmega_8cxx.html#ae2aff2e5ed6ce2ac4391bedb93e0a615">Vint</a></div><div class="ttdeci">std::vector&lt; int &gt; Vint</div><div class="ttdef"><b>Definition:</b> <a href="DzeroOmega_8cxx_source.html#l00065">DzeroOmega.cxx:65</a></div></div>
<div class="ttc" id="namespaceAnaBranches_1_1photon_html_a3f37b0e1d44a6d7f210e6fd5ac87e27e"><div class="ttname"><a href="namespaceAnaBranches_1_1photon.html#a3f37b0e1d44a6d7f210e6fd5ac87e27e">AnaBranches::photon::dang</a></div><div class="ttdeci">double dang</div><div class="ttdoc">Angle difference with nearest charged track.`. </div><div class="ttdef"><b>Definition:</b> <a href="RhopiRootNamespace_8h_source.html#l00052">RhopiRootNamespace.h:52</a></div></div>
<div class="ttc" id="namespaceDzeroPhiBranches_1_1vxyz_html_a17001765d451d0d64eb619ef1321c42f"><div class="ttname"><a href="namespaceDzeroPhiBranches_1_1vxyz.html#a17001765d451d0d64eb619ef1321c42f">DzeroPhiBranches::vxyz::vx</a></div><div class="ttdeci">double vx</div><div class="ttdoc">&lt; Vertex information of each track. </div><div class="ttdef"><b>Definition:</b> <a href="DzeroPhiRootFile_8h_source.html#l00046">DzeroPhiRootFile.h:46</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a188bc0198dd44ae64e236099f2409c56"><div class="ttname"><a href="classRhopiAlg.html#a188bc0198dd44ae64e236099f2409c56">RhopiAlg::fTupleAngles</a></div><div class="ttdeci">NTuple::Tuple * fTupleAngles</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00086">RhopiAlg.h:86</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a201daca75693f83f6bfc62aa657927be"><div class="ttname"><a href="classRhopiAlg.html#a201daca75693f83f6bfc62aa657927be">RhopiAlg::fCntrTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fCntrTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00147">RhopiAlg.h:147</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a4f698122f565c49a9c12934078eb1f64"><div class="ttname"><a href="classRhopiAlg.html#a4f698122f565c49a9c12934078eb1f64">RhopiAlg::fChi2pi</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fChi2pi</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00119">RhopiAlg.h:119</a></div></div>
<div class="ttc" id="classRhopiAlg_html_afa8aac036d2f231159785b3dd8963168"><div class="ttname"><a href="classRhopiAlg.html#afa8aac036d2f231159785b3dd8963168">RhopiAlg::fPathTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fPathTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00160">RhopiAlg.h:160</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a104623b8329459f4a38b3d2b967f27c2"><div class="ttname"><a href="classRhopiAlg.html#a104623b8329459f4a38b3d2b967f27c2">RhopiAlg::fRvphi0</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fRvphi0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00083">RhopiAlg.h:83</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a35a3bbf454e714b0b1fa8f289a75f4d5"><div class="ttname"><a href="classRhopiAlg.html#a35a3bbf454e714b0b1fa8f289a75f4d5">RhopiAlg::fMuonTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fMuonTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00134">RhopiAlg.h:134</a></div></div>
<div class="ttc" id="classRhopiAlg_html_af36844ec30aa092b60451a65f2abbfc1"><div class="ttname"><a href="classRhopiAlg.html#af36844ec30aa092b60451a65f2abbfc1">RhopiAlg::fChi2p</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fChi2p</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00121">RhopiAlg.h:121</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_afc66a2c95f4c764112c430d34ac53985"><div class="ttname"><a href="RhopiAlg_8cxx.html#afc66a2c95f4c764112c430d34ac53985">Ncut4</a></div><div class="ttdeci">int Ncut4</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00072">RhopiAlg.cxx:72</a></div></div>
<div class="ttc" id="namespaceDzeroPhiBranches_1_1fit4c_html_a52e1b31cb72288523689cfd5590e2c18"><div class="ttname"><a href="namespaceDzeroPhiBranches_1_1fit4c.html#a52e1b31cb72288523689cfd5590e2c18">DzeroPhiBranches::fit4c::chi2</a></div><div class="ttdeci">double chi2</div><div class="ttdoc">Chi squared of the Kalman kinematic fit. </div><div class="ttdef"><b>Definition:</b> <a href="DzeroPhiRootFile_8h_source.html#l00060">DzeroPhiRootFile.h:60</a></div></div>
<div class="ttc" id="DzeroOmega_8cxx_html_a188faf2fae63125a32fe38f0567026bc"><div class="ttname"><a href="DzeroOmega_8cxx.html#a188faf2fae63125a32fe38f0567026bc">HepPoint3D</a></div><div class="ttdeci">HepGeom::Point3D&lt; double &gt; HepPoint3D</div><div class="ttdef"><b>Definition:</b> <a href="DzeroOmega_8cxx_source.html#l00037">DzeroOmega.cxx:37</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a759992581423aee745872348f9733ccf"><div class="ttname"><a href="classRhopiAlg.html#a759992581423aee745872348f9733ccf">RhopiAlg::fDeltaTheta</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fDeltaTheta</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00087">RhopiAlg.h:87</a></div></div>
<div class="ttc" id="namespaceDzeroPhiBranches_1_1tofe_html_ae7d336c993e92a76ab4cb8d4e0e5046b"><div class="ttname"><a href="namespaceDzeroPhiBranches_1_1tofe.html#ae7d336c993e92a76ab4cb8d4e0e5046b">DzeroPhiBranches::tofe::qual</a></div><div class="ttdeci">double qual</div><div class="ttdoc">Data quality of reconstruction. </div><div class="ttdef"><b>Definition:</b> <a href="DzeroPhiRootFile_8h_source.html#l00087">DzeroPhiRootFile.h:87</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_a188faf2fae63125a32fe38f0567026bc"><div class="ttname"><a href="RhopiAlg_8cxx.html#a188faf2fae63125a32fe38f0567026bc">HepPoint3D</a></div><div class="ttdeci">HepGeom::Point3D&lt; double &gt; HepPoint3D</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00035">RhopiAlg.cxx:35</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a2104747b628e5e2ca62eea29eab08257"><div class="ttname"><a href="classRhopiAlg.html#a2104747b628e5e2ca62eea29eab08257">RhopiAlg::fNormPH</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fNormPH</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00123">RhopiAlg.h:123</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_a87a44bb9989e7d593d89d0b2b7aa553d"><div class="ttname"><a href="RhopiAlg_8cxx.html#a87a44bb9989e7d593d89d0b2b7aa553d">Ncut5</a></div><div class="ttdeci">int Ncut5</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00073">RhopiAlg.cxx:73</a></div></div>
<div class="ttc" id="classRhopiAlg_html_ae70e62c6743a06c32a6229c09998674f"><div class="ttname"><a href="classRhopiAlg.html#ae70e62c6743a06c32a6229c09998674f">RhopiAlg::fKaonTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fKaonTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00151">RhopiAlg.h:151</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a0ff889bcc8308d10ee9a8e94678e96ca"><div class="ttname"><a href="classRhopiAlg.html#a0ff889bcc8308d10ee9a8e94678e96ca">RhopiAlg::fQualTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fQualTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00155">RhopiAlg.h:155</a></div></div>
<div class="ttc" id="classRhopiAlg_html_ab76937e733cff9572d08436bf9236b16"><div class="ttname"><a href="classRhopiAlg.html#ab76937e733cff9572d08436bf9236b16">RhopiAlg::finalize</a></div><div class="ttdeci">StatusCode finalize()</div><div class="ttdoc">Inherited finalize method of Algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l01020">RhopiAlg.cxx:1020</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a73632dd882bf7c5d743978fa4b940e33"><div class="ttname"><a href="classRhopiAlg.html#a73632dd882bf7c5d743978fa4b940e33">RhopiAlg::fMuonTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fMuonTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00149">RhopiAlg.h:149</a></div></div>
<div class="ttc" id="namespaceDzeroPhiBranches_1_1tofe_html_a3b30c061bb9ddc7c2d680e512438818f"><div class="ttname"><a href="namespaceDzeroPhiBranches_1_1tofe.html#a3b30c061bb9ddc7c2d680e512438818f">DzeroPhiBranches::tofe::path</a></div><div class="ttdeci">double path</div><div class="ttdoc">Path length. </div><div class="ttdef"><b>Definition:</b> <a href="DzeroPhiRootFile_8h_source.html#l00083">DzeroPhiRootFile.h:83</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a3ba7c0f8a9a7e2a3f5278ab81e9d7647"><div class="ttname"><a href="classRhopiAlg.html#a3ba7c0f8a9a7e2a3f5278ab81e9d7647">RhopiAlg::fZhitTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fZhitTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00169">RhopiAlg.h:169</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a3ca2a92d0d8c010926b8e3eb7758f307"><div class="ttname"><a href="classRhopiAlg.html#a3ca2a92d0d8c010926b8e3eb7758f307">RhopiAlg::fMuonTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fMuonTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00164">RhopiAlg.h:164</a></div></div>
<div class="ttc" id="namespaceAnaBranches_1_1photon_html_a37778a99ce76c6c07bad185f7f2e5347"><div class="ttname"><a href="namespaceAnaBranches_1_1photon.html#a37778a99ce76c6c07bad185f7f2e5347">AnaBranches::photon::dthe</a></div><div class="ttdeci">double dthe</div><div class="ttdoc">Theta difference with nearest charged track (degrees).`. </div><div class="ttdef"><b>Definition:</b> <a href="RhopiRootNamespace_8h_source.html#l00050">RhopiRootNamespace.h:50</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a7f0176ebbd3cceef08cf5a8005ff2bdb"><div class="ttname"><a href="classRhopiAlg.html#a7f0176ebbd3cceef08cf5a8005ff2bdb">RhopiAlg::RhopiAlg</a></div><div class="ttdeci">RhopiAlg(const std::string &amp;name, ISvcLocator *pSvcLocator)</div><div class="ttdoc">Constructor for the RhopiAlg algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00086">RhopiAlg.cxx:86</a></div></div>
<div class="ttc" id="classRhopiAlg_html_ac9c83f29cbf8dcd882f21e0f41d72ee6"><div class="ttname"><a href="classRhopiAlg.html#ac9c83f29cbf8dcd882f21e0f41d72ee6">RhopiAlg::fTupleFit4C</a></div><div class="ttdeci">NTuple::Tuple * fTupleFit4C</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00098">RhopiAlg.h:98</a></div></div>
<div class="ttc" id="namespaceDzeroPhiBranches_1_1dedx_html_ac3027e8051061d346762f017795ae4f7"><div class="ttname"><a href="namespaceDzeroPhiBranches_1_1dedx.html#ac3027e8051061d346762f017795ae4f7">DzeroPhiBranches::dedx::ptrk</a></div><div class="ttdeci">double ptrk</div><div class="ttdoc">&lt; Energy loss ( ) PID branch. </div><div class="ttdef"><b>Definition:</b> <a href="DzeroPhiRootFile_8h_source.html#l00069">DzeroPhiRootFile.h:69</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a42987b298b549df8af27578a7c8160f6"><div class="ttname"><a href="classRhopiAlg.html#a42987b298b549df8af27578a7c8160f6">RhopiAlg::initialize</a></div><div class="ttdeci">StatusCode initialize()</div><div class="ttdoc">(Inherited) initialize step of Algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00124">RhopiAlg.cxx:124</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_af1d2be22861b1e83a550b9ca430b58cf"><div class="ttname"><a href="RhopiAlg_8cxx.html#af1d2be22861b1e83a550b9ca430b58cf">Ncut6</a></div><div class="ttdeci">int Ncut6</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00074">RhopiAlg.cxx:74</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a600c1aa0400ea9d9e5c7226a51978c94"><div class="ttname"><a href="classRhopiAlg.html#a600c1aa0400ea9d9e5c7226a51978c94">RhopiAlg::fChi1</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fChi1</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00099">RhopiAlg.h:99</a></div></div>
<div class="ttc" id="classRhopiAlg_html_ab772140290960ca6c561b8f5efe3ac17"><div class="ttname"><a href="classRhopiAlg.html#ab772140290960ca6c561b8f5efe3ac17">RhopiAlg::fThit</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fThit</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00125">RhopiAlg.h:125</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_a4506054600e8230d869ac3c51e807f3a"><div class="ttname"><a href="RhopiAlg_8cxx.html#a4506054600e8230d869ac3c51e807f3a">Ncut1</a></div><div class="ttdeci">int Ncut1</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00069">RhopiAlg.cxx:69</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a6f8865d4c73800ce7e8df868aaf30ae9"><div class="ttname"><a href="classRhopiAlg.html#a6f8865d4c73800ce7e8df868aaf30ae9">RhopiAlg::fProbPID</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fProbPID</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00179">RhopiAlg.h:179</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a3ad054a1e60f0a8dc4ba3e5ab066b229"><div class="ttname"><a href="classRhopiAlg.html#a3ad054a1e60f0a8dc4ba3e5ab066b229">RhopiAlg::fEraw</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fEraw</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00090">RhopiAlg.h:90</a></div></div>
<div class="ttc" id="DzeroOmega_8cxx_html_a66098539bec38058a3d9032d53cbd7ec"><div class="ttname"><a href="DzeroOmega_8cxx.html#a66098539bec38058a3d9032d53cbd7ec">Vp4</a></div><div class="ttdeci">std::vector&lt; HepLorentzVector &gt; Vp4</div><div class="ttdef"><b>Definition:</b> <a href="DzeroOmega_8cxx_source.html#l00066">DzeroOmega.cxx:66</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a843b32c7856026e97d87b7566dcec4de"><div class="ttname"><a href="classRhopiAlg.html#a843b32c7856026e97d87b7566dcec4de">RhopiAlg::fVx0</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fVx0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00077">RhopiAlg.h:77</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a93c6042360744cee6c886ee0ba985504"><div class="ttname"><a href="classRhopiAlg.html#a93c6042360744cee6c886ee0ba985504">RhopiAlg::execute</a></div><div class="ttdeci">StatusCode execute()</div><div class="ttdoc">Inherited execute method of the Algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00368">RhopiAlg.cxx:368</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a64a48c1045ed925d010badcafc28ddfd"><div class="ttname"><a href="classRhopiAlg.html#a64a48c1045ed925d010badcafc28ddfd">RhopiAlg::fChi2mu</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fChi2mu</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00118">RhopiAlg.h:118</a></div></div>
<div class="ttc" id="namespaceDzeroPhiBranches_1_1vxyz_html_ab07d58f450ed9b395ce0a71ddc4edb0c"><div class="ttname"><a href="namespaceDzeroPhiBranches_1_1vxyz.html#ab07d58f450ed9b395ce0a71ddc4edb0c">DzeroPhiBranches::vxyz::phi</a></div><div class="ttdeci">double phi</div><div class="ttdoc">Helix angle of the particle (?). </div><div class="ttdef"><b>Definition:</b> <a href="DzeroPhiRootFile_8h_source.html#l00053">DzeroPhiRootFile.h:53</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a94afbca13e4703e6e9633d338d126ff2"><div class="ttname"><a href="classRhopiAlg.html#a94afbca13e4703e6e9633d338d126ff2">RhopiAlg::fPathTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fPathTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00130">RhopiAlg.h:130</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a00972c94ffc8686f548a1597073ae5d8"><div class="ttname"><a href="classRhopiAlg.html#a00972c94ffc8686f548a1597073ae5d8">RhopiAlg::fGammaAngleCut</a></div><div class="ttdeci">double fGammaAngleCut</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00056">RhopiAlg.h:56</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a62aafbfcb46680e0ea0ed0ff3a5a2c84"><div class="ttname"><a href="classRhopiAlg.html#a62aafbfcb46680e0ea0ed0ff3a5a2c84">RhopiAlg::fElow</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fElow</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00112">RhopiAlg.h:112</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a6f247d2dc0ce778e5986912139bd5ef5"><div class="ttname"><a href="classRhopiAlg.html#a6f247d2dc0ce778e5986912139bd5ef5">RhopiAlg::fTupleFit5C</a></div><div class="ttdeci">NTuple::Tuple * fTupleFit5C</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00103">RhopiAlg.h:103</a></div></div>
<div class="ttc" id="classRhopiAlg_html_adaa4db6028d5fcada93dc8070152c1ed"><div class="ttname"><a href="classRhopiAlg.html#adaa4db6028d5fcada93dc8070152c1ed">RhopiAlg::fVz0cut</a></div><div class="ttdeci">double fVz0cut</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00048">RhopiAlg.h:48</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a260c4fad9f54ab4a7d326a8177696b99"><div class="ttname"><a href="classRhopiAlg.html#a260c4fad9f54ab4a7d326a8177696b99">RhopiAlg::fMrho0</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fMrho0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00105">RhopiAlg.h:105</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a951684079e1201c940c08406eff4460e"><div class="ttname"><a href="classRhopiAlg.html#a951684079e1201c940c08406eff4460e">RhopiAlg::fTof2PID</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fTof2PID</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00178">RhopiAlg.h:178</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a41ed043606bdc4cec9defedf436aa81b"><div class="ttname"><a href="classRhopiAlg.html#a41ed043606bdc4cec9defedf436aa81b">RhopiAlg::fTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00131">RhopiAlg.h:131</a></div></div>
<div class="ttc" id="classRhopiAlg_html_aa88b5abc128a1e4fa47849489a3825da"><div class="ttname"><a href="classRhopiAlg.html#aa88b5abc128a1e4fa47849489a3825da">RhopiAlg::fElectronTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fElectronTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00163">RhopiAlg.h:163</a></div></div>
<div class="ttc" id="classRhopiAlg_html_af8df43bfaf8fa8fa52ff707ee185c42b"><div class="ttname"><a href="classRhopiAlg.html#af8df43bfaf8fa8fa52ff707ee185c42b">RhopiAlg::fPathTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fPathTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00145">RhopiAlg.h:145</a></div></div>
<div class="ttc" id="classRhopiAlg_html_acc0bf0b6203903892120e7987e64827b"><div class="ttname"><a href="classRhopiAlg.html#acc0bf0b6203903892120e7987e64827b">RhopiAlg::fPhTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fPhTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00153">RhopiAlg.h:153</a></div></div>
<div class="ttc" id="classRhopiAlg_html_aae6e6a3b9ee4990b06b9707a381edc17"><div class="ttname"><a href="classRhopiAlg.html#aae6e6a3b9ee4990b06b9707a381edc17">RhopiAlg::fPtrackPID</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fPtrackPID</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00174">RhopiAlg.h:174</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a4ab8fcbab557d9bec8ab8852052277a7"><div class="ttname"><a href="classRhopiAlg.html#a4ab8fcbab557d9bec8ab8852052277a7">RhopiAlg::TupleTofIB</a></div><div class="ttdeci">NTuple::Tuple * TupleTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00143">RhopiAlg.h:143</a></div></div>
<div class="ttc" id="classRhopiAlg_html_aceb706c5131c32c60ebccff68f7c5400"><div class="ttname"><a href="classRhopiAlg.html#aceb706c5131c32c60ebccff68f7c5400">RhopiAlg::fRvxy0cut</a></div><div class="ttdeci">double fRvxy0cut</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00050">RhopiAlg.h:50</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a1f3708b502c4dd8befb59d03a2abe921"><div class="ttname"><a href="classRhopiAlg.html#a1f3708b502c4dd8befb59d03a2abe921">RhopiAlg::fRhitTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fRhitTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00139">RhopiAlg.h:139</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a2c907b2b6d12917ce44b4cf8442738ff"><div class="ttname"><a href="classRhopiAlg.html#a2c907b2b6d12917ce44b4cf8442738ff">RhopiAlg::fGammaPhiCut</a></div><div class="ttdeci">double fGammaPhiCut</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00054">RhopiAlg.h:54</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a6a7475fe62353cd97e797b6ade82c53b"><div class="ttname"><a href="classRhopiAlg.html#a6a7475fe62353cd97e797b6ade82c53b">RhopiAlg::fTupleMgg</a></div><div class="ttdeci">NTuple::Tuple * fTupleMgg</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00093">RhopiAlg.h:93</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a1dae4ef59a4492c62a8255a169251e3c"><div class="ttname"><a href="classRhopiAlg.html#a1dae4ef59a4492c62a8255a169251e3c">RhopiAlg::fVr0cut</a></div><div class="ttdeci">double fVr0cut</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00047">RhopiAlg.h:47</a></div></div>
<div class="ttc" id="classRhopiAlg_html_aaf3f9c4545d1737b04ef0ad329cb37bd"><div class="ttname"><a href="classRhopiAlg.html#aaf3f9c4545d1737b04ef0ad329cb37bd">RhopiAlg::fFcos</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fFcos</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00111">RhopiAlg.h:111</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_ac2ba08e98354f1ae771562ba95993cee"><div class="ttname"><a href="RhopiAlg_8cxx.html#ac2ba08e98354f1ae771562ba95993cee">velc_cm</a></div><div class="ttdeci">const double velc_cm</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00057">RhopiAlg.cxx:57</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a85df4b2f0fdc23b823a4c31678d4d5c0"><div class="ttname"><a href="classRhopiAlg.html#a85df4b2f0fdc23b823a4c31678d4d5c0">RhopiAlg::fPhTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fPhTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00138">RhopiAlg.h:138</a></div></div>
<div class="ttc" id="namespaceDzeroPhiBranches_1_1tofe_html_af373be79b614efa509c3a7150ec4ddba"><div class="ttname"><a href="namespaceDzeroPhiBranches_1_1tofe.html#af373be79b614efa509c3a7150ec4ddba">DzeroPhiBranches::tofe::rhit</a></div><div class="ttdeci">double rhit</div><div class="ttdoc">Track extrapolate  or  Hit position. </div><div class="ttdef"><b>Definition:</b> <a href="DzeroPhiRootFile_8h_source.html#l00086">DzeroPhiRootFile.h:86</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a2813e7bba4ead1913f5bd883cf475e65"><div class="ttname"><a href="classRhopiAlg.html#a2813e7bba4ead1913f5bd883cf475e65">RhopiAlg::fDeltaMrho0</a></div><div class="ttdeci">double fDeltaMrho0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00059">RhopiAlg.h:59</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_a123ac7871ce3ce2f3ef73eddc6aae85a"><div class="ttname"><a href="RhopiAlg_8cxx.html#a123ac7871ce3ce2f3ef73eddc6aae85a">Ecms</a></div><div class="ttdeci">const double Ecms</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00059">RhopiAlg.cxx:59</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a624abc570b4263b26674f081b866b90c"><div class="ttname"><a href="classRhopiAlg.html#a624abc570b4263b26674f081b866b90c">RhopiAlg::fDedxPID</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fDedxPID</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00176">RhopiAlg.h:176</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a8e349c1966478c78c8489c9d9e5a826b"><div class="ttname"><a href="classRhopiAlg.html#a8e349c1966478c78c8489c9d9e5a826b">RhopiAlg::fRvz0</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fRvz0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00082">RhopiAlg.h:82</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a98145ec36df7b86c7bcfaf053e23d23b"><div class="ttname"><a href="classRhopiAlg.html#a98145ec36df7b86c7bcfaf053e23d23b">RhopiAlg::fProtonTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fProtonTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00152">RhopiAlg.h:152</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a572a503c110e057b11839a9ea0bffd39"><div class="ttname"><a href="classRhopiAlg.html#a572a503c110e057b11839a9ea0bffd39">RhopiAlg::fKaonTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fKaonTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00136">RhopiAlg.h:136</a></div></div>
<div class="ttc" id="classRhopiAlg_html_ae291cc82d5644cd4d7224c3fbce754b5"><div class="ttname"><a href="classRhopiAlg.html#ae291cc82d5644cd4d7224c3fbce754b5">RhopiAlg::fMpi0</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fMpi0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00100">RhopiAlg.h:100</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_a83e267c1596c352aefaeb2c2551d637c"><div class="ttname"><a href="RhopiAlg_8cxx.html#a83e267c1596c352aefaeb2c2551d637c">Ncut0</a></div><div class="ttdeci">int Ncut0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00068">RhopiAlg.cxx:68</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a2cd6ce4caafc790e99087214fb6a4e08"><div class="ttname"><a href="classRhopiAlg.html#a2cd6ce4caafc790e99087214fb6a4e08">RhopiAlg::fVz0</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fVz0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00079">RhopiAlg.h:79</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a1ca43015d229652bde1e02036409cb59"><div class="ttname"><a href="classRhopiAlg.html#a1ca43015d229652bde1e02036409cb59">RhopiAlg::fProtoniTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fProtoniTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00165">RhopiAlg.h:165</a></div></div>
<div class="ttc" id="classRhopiAlg_html_aedf990ba7ccef5dd9504a9f103c22937"><div class="ttname"><a href="classRhopiAlg.html#aedf990ba7ccef5dd9504a9f103c22937">RhopiAlg::fTupleTofEC</a></div><div class="ttdeci">NTuple::Tuple * fTupleTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00128">RhopiAlg.h:128</a></div></div>
<div class="ttc" id="classRhopiAlg_html_ac860765c5d5011e18e96c88dbe1d8152"><div class="ttname"><a href="classRhopiAlg.html#ac860765c5d5011e18e96c88dbe1d8152">RhopiAlg::fTof1PID</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fTof1PID</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00177">RhopiAlg.h:177</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_ae2aff2e5ed6ce2ac4391bedb93e0a615"><div class="ttname"><a href="RhopiAlg_8cxx.html#ae2aff2e5ed6ce2ac4391bedb93e0a615">Vint</a></div><div class="ttdeci">std::vector&lt; int &gt; Vint</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00063">RhopiAlg.cxx:63</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_a66098539bec38058a3d9032d53cbd7ec"><div class="ttname"><a href="RhopiAlg_8cxx.html#a66098539bec38058a3d9032d53cbd7ec">Vp4</a></div><div class="ttdeci">std::vector&lt; HepLorentzVector &gt; Vp4</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00064">RhopiAlg.cxx:64</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a883806ad7d0da9a3e35538c018b11f36"><div class="ttname"><a href="classRhopiAlg.html#a883806ad7d0da9a3e35538c018b11f36">RhopiAlg::fProtoniTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fProtoniTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00135">RhopiAlg.h:135</a></div></div>
<div class="ttc" id="classRhopiAlg_html_afc7aa7620209a9b2935d9bbd0dc2e6cc"><div class="ttname"><a href="classRhopiAlg.html#afc7aa7620209a9b2935d9bbd0dc2e6cc">RhopiAlg::fQualTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fQualTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00170">RhopiAlg.h:170</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a866d950f28ee6301700e2cd323033ee3"><div class="ttname"><a href="classRhopiAlg.html#a866d950f28ee6301700e2cd323033ee3">RhopiAlg::fChi2</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fChi2</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00104">RhopiAlg.h:104</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_abdd8572dc795b0d4176087cdc0a2bfe1"><div class="ttname"><a href="RhopiAlg_8cxx.html#abdd8572dc795b0d4176087cdc0a2bfe1">Ncut3</a></div><div class="ttdeci">int Ncut3</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00071">RhopiAlg.cxx:71</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a85bfe78eb173354f1755694067deb1a0"><div class="ttname"><a href="classRhopiAlg.html#a85bfe78eb173354f1755694067deb1a0">RhopiAlg::fElectronst4C</a></div><div class="ttdeci">bool fElectronst4C</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00062">RhopiAlg.h:62</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a4070e381f84ed203745d46c27f7560df"><div class="ttname"><a href="classRhopiAlg.html#a4070e381f84ed203745d46c27f7560df">RhopiAlg::fTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00146">RhopiAlg.h:146</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a1b65a274eaffc58ed048746eb3e446ff"><div class="ttname"><a href="classRhopiAlg.html#a1b65a274eaffc58ed048746eb3e446ff">RhopiAlg::fChi2k</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fChi2k</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00120">RhopiAlg.h:120</a></div></div>
<div class="ttc" id="DzeroPhi_8cxx_html_a4280a7c0dacc8860173bdd2ffbdb0a3b"><div class="ttname"><a href="DzeroPhi_8cxx.html#a4280a7c0dacc8860173bdd2ffbdb0a3b">ecms</a></div><div class="ttdeci">const HepLorentzVector ecms(0.034, 0, 0, Ecms)</div></div>
<div class="ttc" id="classRhopiAlg_html_a3ceff76f3adca90d18069131280ede62"><div class="ttname"><a href="classRhopiAlg.html#a3ceff76f3adca90d18069131280ede62">RhopiAlg::fPtotTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fPtotTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00159">RhopiAlg.h:159</a></div></div>
<div class="ttc" id="namespaceDzeroPhiBranches_1_1tofe_html_ab22fccdebfb2fbafc8ec06367ea23603"><div class="ttname"><a href="namespaceDzeroPhiBranches_1_1tofe.html#ab22fccdebfb2fbafc8ec06367ea23603">DzeroPhiBranches::tofe::ph</a></div><div class="ttdeci">double ph</div><div class="ttdoc">ToF pulse height. </div><div class="ttdef"><b>Definition:</b> <a href="DzeroPhiRootFile_8h_source.html#l00085">DzeroPhiRootFile.h:85</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a24d545fdc4dcc0bd351ced7527104445"><div class="ttname"><a href="classRhopiAlg.html#a24d545fdc4dcc0bd351ced7527104445">RhopiAlg::fVy0</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fVy0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00078">RhopiAlg.h:78</a></div></div>
<div class="ttc" id="classRhopiAlg_html_ad6449cfc87feeea89302fb1e8667c7ac"><div class="ttname"><a href="classRhopiAlg.html#ad6449cfc87feeea89302fb1e8667c7ac">RhopiAlg::fTuplePhoton</a></div><div class="ttdeci">NTuple::Tuple * fTuplePhoton</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00110">RhopiAlg.h:110</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a8d07c968212f4b83442f49e254dd2670"><div class="ttname"><a href="classRhopiAlg.html#a8d07c968212f4b83442f49e254dd2670">RhopiAlg::fMtoGG</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fMtoGG</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00094">RhopiAlg.h:94</a></div></div>
<div class="ttc" id="classRhopiAlg_html_aac54be27822ab83575a16ad4b796ad78"><div class="ttname"><a href="classRhopiAlg.html#aac54be27822ab83575a16ad4b796ad78">RhopiAlg::fMrhop</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fMrhop</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00106">RhopiAlg.h:106</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a92e7f99a73482be4d206bd4dc86e83dc"><div class="ttname"><a href="classRhopiAlg.html#a92e7f99a73482be4d206bd4dc86e83dc">RhopiAlg::TupleTofOB</a></div><div class="ttdeci">NTuple::Tuple * TupleTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00158">RhopiAlg.h:158</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a638cbad7bd516bac660cbf9098bfb0d5"><div class="ttname"><a href="classRhopiAlg.html#a638cbad7bd516bac660cbf9098bfb0d5">RhopiAlg::fPtotTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fPtotTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00144">RhopiAlg.h:144</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a383964930e74fe9fc4f3bacde18b3423"><div class="ttname"><a href="classRhopiAlg.html#a383964930e74fe9fc4f3bacde18b3423">RhopiAlg::fRvxy0</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fRvxy0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00081">RhopiAlg.h:81</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a052ad1d216f1006d00a162f7a2548111"><div class="ttname"><a href="classRhopiAlg.html#a052ad1d216f1006d00a162f7a2548111">RhopiAlg::fDeltaAngle</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fDeltaAngle</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00089">RhopiAlg.h:89</a></div></div>
<div class="ttc" id="classRhopiAlg_html_acb3f3e60fff80d1614bf8f074569cdd4"><div class="ttname"><a href="classRhopiAlg.html#acb3f3e60fff80d1614bf8f074569cdd4">RhopiAlg::fTupleVxyz</a></div><div class="ttdeci">NTuple::Tuple * fTupleVxyz</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00076">RhopiAlg.h:76</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a377fb2c23a974a2bf751176e2a67ee38"><div class="ttname"><a href="classRhopiAlg.html#a377fb2c23a974a2bf751176e2a67ee38">RhopiAlg::fDeltaPhi</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fDeltaPhi</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00088">RhopiAlg.h:88</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_aa99b02ee88055b799a547ebf230ed310"><div class="ttname"><a href="RhopiAlg_8cxx.html#aa99b02ee88055b799a547ebf230ed310">velc_mm</a></div><div class="ttdeci">const double velc_mm</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00058">RhopiAlg.cxx:58</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a624b27fcf9cc3ec90cc6ddf7326f3dc6"><div class="ttname"><a href="classRhopiAlg.html#a624b27fcf9cc3ec90cc6ddf7326f3dc6">RhopiAlg::fMrhom</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fMrhom</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00107">RhopiAlg.h:107</a></div></div>
<div class="ttc" id="classRhopiAlg_html_aa9c7c0701477d8155871115a28b6a0ed"><div class="ttname"><a href="classRhopiAlg.html#aa9c7c0701477d8155871115a28b6a0ed">RhopiAlg::fCostPID</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fCostPID</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00175">RhopiAlg.h:175</a></div></div>
<div class="ttc" id="RhopiAlg_8h_html"><div class="ttname"><a href="RhopiAlg_8h.html">RhopiAlg.h</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a50604008aeb7c1eddf622a0e0a535124"><div class="ttname"><a href="classRhopiAlg.html#a50604008aeb7c1eddf622a0e0a535124">RhopiAlg::fPhTofOB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fPhTofOB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00168">RhopiAlg.h:168</a></div></div>
<div class="ttc" id="classRhopiAlg_html_aebb4764f43dc107037bbafc4cc5ba07f"><div class="ttname"><a href="classRhopiAlg.html#aebb4764f43dc107037bbafc4cc5ba07f">RhopiAlg::fProbPH</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fProbPH</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00122">RhopiAlg.h:122</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a7b826bbc65599849e296f249c112a401"><div class="ttname"><a href="classRhopiAlg.html#a7b826bbc65599849e296f249c112a401">RhopiAlg::fZhitTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fZhitTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00154">RhopiAlg.h:154</a></div></div>
<div class="ttc" id="classRhopiAlg_html_ae453281b12586262b1bb4f058ee1e6bf"><div class="ttname"><a href="classRhopiAlg.html#ae453281b12586262b1bb4f058ee1e6bf">RhopiAlg::fGammaThetaCut</a></div><div class="ttdeci">double fGammaThetaCut</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00055">RhopiAlg.h:55</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_ab7b35acf658c14d92b5b892a4fa74761"><div class="ttname"><a href="RhopiAlg_8cxx.html#ab7b35acf658c14d92b5b892a4fa74761">mpi0</a></div><div class="ttdeci">const double mpi0</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00048">RhopiAlg.cxx:48</a></div></div>
<div class="ttc" id="classRhopiAlg_html_ab6732e46d103fd424a74e25325c41302"><div class="ttname"><a href="classRhopiAlg.html#ab6732e46d103fd424a74e25325c41302">RhopiAlg::fProtoniTofIB</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fProtoniTofIB</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00150">RhopiAlg.h:150</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a4bc326b667210f3d1cde8f2b12889c6f"><div class="ttname"><a href="classRhopiAlg.html#a4bc326b667210f3d1cde8f2b12889c6f">RhopiAlg::fTupleDedx</a></div><div class="ttdeci">NTuple::Tuple * fTupleDedx</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00115">RhopiAlg.h:115</a></div></div>
<div class="ttc" id="classRhopiAlg_html_aa75fec796d7f94e51263bb8ccfb6e46d"><div class="ttname"><a href="classRhopiAlg.html#aa75fec796d7f94e51263bb8ccfb6e46d">RhopiAlg::fElectronTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fElectronTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00133">RhopiAlg.h:133</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a0ac1cb08a0a7b847b4a50e35dd6a5434"><div class="ttname"><a href="classRhopiAlg.html#a0ac1cb08a0a7b847b4a50e35dd6a5434">RhopiAlg::fEnergyThreshold</a></div><div class="ttdeci">double fEnergyThreshold</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00053">RhopiAlg.h:53</a></div></div>
<div class="ttc" id="classRhopiAlg_html_aa0b82adab74d48f63aa4c684f477fab9"><div class="ttname"><a href="classRhopiAlg.html#aa0b82adab74d48f63aa4c684f477fab9">RhopiAlg::fQualTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fQualTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00140">RhopiAlg.h:140</a></div></div>
<div class="ttc" id="RhopiAlg_8cxx_html_a850891ce5a4a85d92f96c37288dc134a"><div class="ttname"><a href="RhopiAlg_8cxx.html#a850891ce5a4a85d92f96c37288dc134a">xmass</a></div><div class="ttdeci">const double xmass[5]</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8cxx_source.html#l00050">RhopiAlg.cxx:50</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a67fee3f1672e9ae8754235e4d67bcf9a"><div class="ttname"><a href="classRhopiAlg.html#a67fee3f1672e9ae8754235e4d67bcf9a">RhopiAlg::fCheckTof</a></div><div class="ttdeci">bool fCheckTof</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00068">RhopiAlg.h:68</a></div></div>
<div class="ttc" id="namespaceAnaBranches_1_1geff_html_ab1b2038cc91d589656c6027de815734e"><div class="ttname"><a href="namespaceAnaBranches_1_1geff.html#ab1b2038cc91d589656c6027de815734e">AnaBranches::geff::fcos</a></div><div class="ttdeci">double fcos</div><div class="ttdoc">E/p ratio for pi^0 candidate. </div><div class="ttdef"><b>Definition:</b> <a href="RhopiRootNamespace_8h_source.html#l00158">RhopiRootNamespace.h:158</a></div></div>
<div class="ttc" id="classRhopiAlg_html_a6bff023a7ad0e81acf00eecf654b6680"><div class="ttname"><a href="classRhopiAlg.html#a6bff023a7ad0e81acf00eecf654b6680">RhopiAlg::fPtotTofEC</a></div><div class="ttdeci">NTuple::Item&lt; double &gt; fPtotTofEC</div><div class="ttdef"><b>Definition:</b> <a href="RhopiAlg_8h_source.html#l00129">RhopiAlg.h:129</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d512eca388d0304a639bcc3038caaed2.html">boss</a></li><li class="navelem"><a class="el" href="dir_f89e2a3a4e3f7e3cd35f1001020acb3a.html">workarea</a></li><li class="navelem"><a class="el" href="dir_deefc57b6511e7f47a898946c4bd43a9.html">Analysis</a></li><li class="navelem"><a class="el" href="dir_7c38c780e5c5f17ee51e062c3a587284.html">Physics</a></li><li class="navelem"><a class="el" href="dir_17bc7b17d713cb667d874de48edd4743.html">RhopiAlg</a></li><li class="navelem"><a class="el" href="dir_8546b1a6a7c1e2e2e6c461b9850444f3.html">RhopiAlg-01-00-00</a></li><li class="navelem"><a class="el" href="dir_2d1d011c077f67cfd66aa86fe5e90bd1.html">src</a></li><li class="navelem"><a class="el" href="RhopiAlg_8cxx.html">RhopiAlg.cxx</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
